{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { createStore } from 'vuex';\n\n// Initial state\nconst getDefaultState = () => {\n  return {\n    user: null,\n    isAuthenticated: false,\n    token: null,\n    subscription: null,\n    isLoading: false,\n    toast: {\n      show: false,\n      message: '',\n      type: 'info',\n      // 'success', 'error', 'info', 'warning'\n      duration: 3000\n    },\n    homePageData: null\n  };\n};\n\n// Load user data from localStorage safely\nconst loadUserData = () => {\n  try {\n    const user = localStorage.getItem('user');\n    const token = localStorage.getItem('token');\n    const isAuthenticated = localStorage.getItem('isAuthenticated') === 'true';\n    if (user && token && isAuthenticated) {\n      return {\n        user: JSON.parse(user),\n        isAuthenticated: true,\n        token: token\n      };\n    }\n  } catch (error) {\n    console.error('Error loading user data from localStorage:', error);\n    // Clear corrupted data\n    localStorage.removeItem('user');\n    localStorage.removeItem('token');\n    localStorage.removeItem('isAuthenticated');\n  }\n  return {\n    user: null,\n    isAuthenticated: false,\n    token: null\n  };\n};\nexport default createStore({\n  state: {\n    ...getDefaultState(),\n    ...loadUserData()\n  },\n  mutations: {\n    setUser(state, user) {\n      state.user = user;\n      state.isAuthenticated = !!user;\n      // Sync with localStorage\n      localStorage.setItem('user', JSON.stringify(user));\n      localStorage.setItem('isAuthenticated', 'true');\n    },\n    setAuthenticated(state, value) {\n      state.isAuthenticated = value;\n      localStorage.setItem('isAuthenticated', value.toString());\n    },\n    setToken(state, token) {\n      state.token = token;\n      if (token) {\n        localStorage.setItem('token', token);\n      } else {\n        localStorage.removeItem('token');\n      }\n    },\n    setLoading(state, value) {\n      state.isLoading = value;\n    },\n    setSubscription(state, subscription) {\n      state.subscription = subscription;\n    },\n    logout(state) {\n      // Clear all localStorage items\n      localStorage.clear();\n      sessionStorage.clear();\n\n      // Clear specific items to be sure\n      localStorage.removeItem('user');\n      localStorage.removeItem('isAuthenticated');\n      localStorage.removeItem('token');\n      localStorage.removeItem('subscription');\n      localStorage.removeItem('csrfToken');\n      localStorage.removeItem('pending_payment');\n      localStorage.removeItem('registrationSuccess');\n      localStorage.removeItem('registrationMessage');\n      localStorage.removeItem('loginSuccess');\n      localStorage.removeItem('loginMessage');\n      localStorage.removeItem('hasCompletedRegistration');\n      localStorage.removeItem('app_version');\n\n      // Reset state\n      Object.assign(state, getDefaultState());\n\n      // Clear cookies\n      document.cookie.split(\";\").forEach(function (c) {\n        document.cookie = c.replace(/^ +/, \"\").replace(/=.*/, \"=;expires=\" + new Date().toUTCString() + \";path=/\");\n      });\n    },\n    RESET_STATE(state) {\n      Object.assign(state, getDefaultState());\n    },\n    showToast(state, {\n      message,\n      type = 'info',\n      duration = 3000\n    }) {\n      state.toast = {\n        show: true,\n        message,\n        type,\n        duration\n      };\n    },\n    hideToast(state) {\n      state.toast.show = false;\n    },\n    setHomePageData(state, data) {\n      state.homePageData = data;\n    },\n    clearHomePageData(state) {\n      state.homePageData = null;\n    }\n  },\n  actions: {\n    initializeStore({\n      commit\n    }) {\n      // Load user data from localStorage on app start\n      const user = JSON.parse(localStorage.getItem('user'));\n      const token = localStorage.getItem('token');\n      if (user && token) {\n        commit('setUser', user);\n        commit('setToken', token);\n      }\n    },\n    logout({\n      commit\n    }) {\n      commit('logout');\n    },\n    resetState({\n      commit\n    }) {\n      return new Promise(resolve => {\n        commit('RESET_STATE');\n        resolve();\n      });\n    },\n    setLoading({\n      commit\n    }, value) {\n      commit('setLoading', value);\n    },\n    showToast({\n      commit\n    }, {\n      message,\n      type,\n      duration\n    }) {\n      commit('showToast', {\n        message,\n        type,\n        duration\n      });\n      setTimeout(() => {\n        commit('hideToast');\n      }, duration || 3000);\n    }\n  },\n  getters: {\n    isLoading: state => state.isLoading,\n    isAuthenticated: state => state.isAuthenticated,\n    currentUser: state => state.user,\n    hasActiveSubscription: state => !!state.subscription,\n    subscriptionDetails: state => state.subscription,\n    token: state => state.token,\n    toast: state => state.toast,\n    homePageData: state => state.homePageData\n  }\n});","map":{"version":3,"names":["createStore","getDefaultState","user","isAuthenticated","token","subscription","isLoading","toast","show","message","type","duration","homePageData","loadUserData","localStorage","getItem","JSON","parse","error","console","removeItem","state","mutations","setUser","setItem","stringify","setAuthenticated","value","toString","setToken","setLoading","setSubscription","logout","clear","sessionStorage","Object","assign","document","cookie","split","forEach","c","replace","Date","toUTCString","RESET_STATE","showToast","hideToast","setHomePageData","data","clearHomePageData","actions","initializeStore","commit","resetState","Promise","resolve","setTimeout","getters","currentUser","hasActiveSubscription","subscriptionDetails"],"sources":["F:/ott_tv/ott/ott_frontend/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\n\n// Initial state\nconst getDefaultState = () => {\n  return {\n    user: null,\n    isAuthenticated: false,\n    token: null,\n    subscription: null,\n    isLoading: false,\n    toast: {\n      show: false,\n      message: '',\n      type: 'info', // 'success', 'error', 'info', 'warning'\n      duration: 3000\n    },\n    homePageData: null\n  };\n};\n\n// Load user data from localStorage safely\nconst loadUserData = () => {\n  try {\n    const user = localStorage.getItem('user');\n    const token = localStorage.getItem('token');\n    const isAuthenticated = localStorage.getItem('isAuthenticated') === 'true';\n    \n    if (user && token && isAuthenticated) {\n      return {\n        user: JSON.parse(user),\n        isAuthenticated: true,\n        token: token\n      };\n    }\n  } catch (error) {\n    console.error('Error loading user data from localStorage:', error);\n    // Clear corrupted data\n    localStorage.removeItem('user');\n    localStorage.removeItem('token');\n    localStorage.removeItem('isAuthenticated');\n  }\n  \n  return {\n    user: null,\n    isAuthenticated: false,\n    token: null\n  };\n};\n\nexport default createStore({\n  state: {\n    ...getDefaultState(),\n    ...loadUserData()\n  },\n  mutations: {\n    setUser(state, user) {\n      state.user = user;\n      state.isAuthenticated = !!user;\n      // Sync with localStorage\n      localStorage.setItem('user', JSON.stringify(user));\n      localStorage.setItem('isAuthenticated', 'true');\n    },\n    setAuthenticated(state, value) {\n      state.isAuthenticated = value;\n      localStorage.setItem('isAuthenticated', value.toString());\n    },\n    setToken(state, token) {\n      state.token = token;\n      if (token) {\n        localStorage.setItem('token', token);\n      } else {\n        localStorage.removeItem('token');\n      }\n    },\n    setLoading(state, value) {\n      state.isLoading = value;\n    },\n    setSubscription(state, subscription) {\n      state.subscription = subscription;\n    },\n    logout(state) {\n      // Clear all localStorage items\n      localStorage.clear();\n      sessionStorage.clear();\n      \n      // Clear specific items to be sure\n      localStorage.removeItem('user');\n      localStorage.removeItem('isAuthenticated');\n      localStorage.removeItem('token');\n      localStorage.removeItem('subscription');\n      localStorage.removeItem('csrfToken');\n      localStorage.removeItem('pending_payment');\n      localStorage.removeItem('registrationSuccess');\n      localStorage.removeItem('registrationMessage');\n      localStorage.removeItem('loginSuccess');\n      localStorage.removeItem('loginMessage');\n      localStorage.removeItem('hasCompletedRegistration');\n      localStorage.removeItem('app_version');\n      \n      // Reset state\n      Object.assign(state, getDefaultState());\n      \n      // Clear cookies\n      document.cookie.split(\";\").forEach(function(c) { \n        document.cookie = c.replace(/^ +/, \"\").replace(/=.*/, \"=;expires=\" + new Date().toUTCString() + \";path=/\"); \n      });\n    },\n    RESET_STATE(state) {\n      Object.assign(state, getDefaultState());\n    },\n    showToast(state, { message, type = 'info', duration = 3000 }) {\n      state.toast = {\n        show: true,\n        message,\n        type,\n        duration\n      };\n    },\n    hideToast(state) {\n      state.toast.show = false;\n    },\n    setHomePageData(state, data) {\n      state.homePageData = data\n    },\n    clearHomePageData(state) {\n      state.homePageData = null\n    }\n  },\n  actions: {\n    initializeStore({ commit }) {\n      // Load user data from localStorage on app start\n      const user = JSON.parse(localStorage.getItem('user'));\n      const token = localStorage.getItem('token');\n      if (user && token) {\n        commit('setUser', user);\n        commit('setToken', token);\n      }\n    },\n    logout({ commit }) {\n      commit('logout');\n    },\n    resetState({ commit }) {\n      return new Promise((resolve) => {\n        commit('RESET_STATE');\n        resolve();\n      });\n    },\n    setLoading({ commit }, value) {\n      commit('setLoading', value);\n    },\n    showToast({ commit }, { message, type, duration }) {\n      commit('showToast', { message, type, duration });\n      setTimeout(() => {\n        commit('hideToast');\n      }, duration || 3000);\n    }\n  },\n  getters: {\n    isLoading: state => state.isLoading,\n    isAuthenticated: state => state.isAuthenticated,\n    currentUser: state => state.user,\n    hasActiveSubscription: state => !!state.subscription,\n    subscriptionDetails: state => state.subscription,\n    token: state => state.token,\n    toast: state => state.toast,\n    homePageData: state => state.homePageData\n  }\n}) "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}