{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { useStore } from 'vuex';\nimport { ref, computed, onMounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport axios from 'axios';\nexport default {\n  name: 'DeviceActivation',\n  setup() {\n    const store = useStore();\n    const router = useRouter();\n    const activationCode = ref('');\n    const isActivating = ref(false);\n    const errorMessage = ref('');\n    const successMessage = ref('');\n\n    // Computed properties from store\n    const isAuthenticated = computed(() => store.getters.isAuthenticated);\n    const user = computed(() => store.getters.currentUser);\n    const token = computed(() => store.getters.token);\n\n    // Format activation code (uppercase, remove spaces)\n    const formatCode = () => {\n      activationCode.value = activationCode.value.toUpperCase().replace(/[^A-Z0-9]/g, '').slice(0, 8);\n    };\n\n    // Activate device\n    const activateDevice = async () => {\n      if (!isAuthenticated.value || !activationCode.value || activationCode.value.length !== 8) {\n        return;\n      }\n      isActivating.value = true;\n      errorMessage.value = '';\n      successMessage.value = '';\n      try {\n        // Set authorization header\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token.value}`;\n\n        // Call activation API\n        const response = await axios.post('/users/api/device-activation/', {\n          activation_code: activationCode.value,\n          device_id: `web_${Date.now()}`,\n          // Generate a temporary device ID\n          device_name: 'Web Activation',\n          device_type: 'web',\n          phone: user.value.phone\n        });\n        if (response.data.status === 'success') {\n          successMessage.value = 'Device activated successfully! Your TV should now have access to premium content.';\n\n          // Show success toast\n          store.dispatch('showToast', {\n            message: 'Device activated successfully!',\n            type: 'success'\n          });\n\n          // Redirect to profile after a delay\n          setTimeout(() => {\n            router.push('/profile');\n          }, 3000);\n        } else {\n          throw new Error(response.data.message || 'Failed to activate device');\n        }\n      } catch (error) {\n        console.error('Activation error:', error);\n        errorMessage.value = error.response?.data?.message || 'Failed to activate device. Please try again.';\n\n        // Show error toast\n        store.dispatch('showToast', {\n          message: errorMessage.value,\n          type: 'error'\n        });\n      } finally {\n        isActivating.value = false;\n      }\n    };\n\n    // Check for code in URL parameters\n    onMounted(() => {\n      const urlParams = new URLSearchParams(window.location.search);\n      const code = urlParams.get('code');\n      if (code) {\n        activationCode.value = code;\n        formatCode();\n      }\n    });\n    return {\n      activationCode,\n      isActivating,\n      errorMessage,\n      successMessage,\n      isAuthenticated,\n      user,\n      formatCode,\n      activateDevice\n    };\n  }\n};","map":{"version":3,"names":["useStore","ref","computed","onMounted","useRouter","axios","name","setup","store","router","activationCode","isActivating","errorMessage","successMessage","isAuthenticated","getters","user","currentUser","token","formatCode","value","toUpperCase","replace","slice","activateDevice","length","defaults","headers","common","response","post","activation_code","device_id","Date","now","device_name","device_type","phone","data","status","dispatch","message","type","setTimeout","push","Error","error","console","urlParams","URLSearchParams","window","location","search","code","get"],"sources":["F:\\ott_tv\\ott_frontend\\src\\views\\DeviceActivation.vue"],"sourcesContent":["<template>\r\n  <div class=\"min-h-screen bg-gradient-to-br from-[#0a0a0a] via-[#1a1a1a] to-[#0f0f0f] text-white\">\r\n    <!-- Header -->\r\n    <div class=\"px-4 py-6\">\r\n      <div class=\"max-w-7xl mx-auto\">\r\n        <router-link to=\"/\" class=\"flex items-center gap-3 text-white/80 hover:text-white transition-colors group\">\r\n          <div class=\"w-10 h-10 bg-gradient-to-r from-[#c30059] to-[#ff6b9d] rounded-lg flex items-center justify-center group-hover:scale-105 transition-transform\">\r\n            <i class=\"fas fa-arrow-left text-lg\"></i>\r\n          </div>\r\n          <span class=\"font-medium\">Back to Home</span>\r\n        </router-link>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Main Content -->\r\n    <div class=\"px-4 py-8\">\r\n      <div class=\"max-w-4xl mx-auto\">\r\n        <div class=\"text-center mb-12\">\r\n          <h1 class=\"text-4xl md:text-5xl font-bold mb-4\">\r\n            Activate Your <span class=\"text-[#c30059]\">TV Device</span>\r\n          </h1>\r\n          <p class=\"text-lg text-white/70 max-w-2xl mx-auto\">\r\n            Enter the activation code displayed on your TV screen to link your device to your account\r\n          </p>\r\n        </div>\r\n\r\n        <div class=\"bg-gradient-to-br from-[#1a1a1a] to-[#2a2a2a] rounded-3xl border border-white/10 p-8 max-w-2xl mx-auto\">\r\n          <!-- Activation Form -->\r\n          <div class=\"space-y-6\">\r\n            <div>\r\n              <label class=\"block text-sm font-medium text-white/80 mb-3\">Activation Code</label>\r\n              <input \r\n                v-model=\"activationCode\"\r\n                type=\"text\"\r\n                class=\"w-full bg-[#0a0a0a] border border-white/10 rounded-xl h-14 px-4 text-white text-lg font-mono tracking-wider focus:border-[#c30059] focus:outline-none focus:ring-2 focus:ring-[#c30059]/20 transition-all uppercase placeholder-white/40 text-center\"\r\n                placeholder=\"ENTER CODE\"\r\n                maxlength=\"8\"\r\n                @input=\"formatCode\"\r\n              />\r\n            </div>\r\n\r\n            <!-- User Info (if logged in) -->\r\n            <div v-if=\"isAuthenticated\" class=\"bg-[#0a0a0a]/50 border border-white/10 rounded-xl p-4\">\r\n              <div class=\"flex items-center gap-3\">\r\n                <div class=\"w-10 h-10 rounded-full bg-gradient-to-r from-[#c30059] to-[#ff6b9d] flex items-center justify-center\">\r\n                  <i class=\"fas fa-user text-white\"></i>\r\n                </div>\r\n                <div>\r\n                  <div class=\"font-medium text-white\">{{ user.first_name }} {{ user.last_name }}</div>\r\n                  <div class=\"text-sm text-white/60\">{{ user.phone }}</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Login Prompt (if not logged in) -->\r\n            <div v-else class=\"bg-amber-500/10 border border-amber-500/30 rounded-xl p-4\">\r\n              <div class=\"flex items-start gap-3\">\r\n                <i class=\"fas fa-exclamation-triangle text-amber-400 mt-0.5\"></i>\r\n                <div>\r\n                  <div class=\"font-medium text-amber-400 mb-1\">Login Required</div>\r\n                  <p class=\"text-sm text-amber-300\">\r\n                    You need to be logged in to activate your device. Please login or create an account.\r\n                  </p>\r\n                  <router-link \r\n                    to=\"/login\" \r\n                    class=\"inline-block mt-3 px-4 py-2 bg-gradient-to-r from-[#c30059] to-[#ff6b9d] text-white text-sm font-medium rounded-lg hover:shadow-lg hover:shadow-[#c30059]/25 transition-all\"\r\n                  >\r\n                    Login to Continue\r\n                  </router-link>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Activate Button -->\r\n            <button \r\n              @click=\"activateDevice\"\r\n              :disabled=\"!isAuthenticated || !activationCode || activationCode.length !== 8 || isActivating\"\r\n              class=\"w-full py-4 px-6 bg-gradient-to-r from-[#c30059] to-[#ff6b9d] text-white font-bold rounded-xl hover:shadow-lg hover:shadow-[#c30059]/25 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-none\"\r\n            >\r\n              <span v-if=\"isActivating\">\r\n                <i class=\"fas fa-spinner fa-spin mr-2\"></i>\r\n                Activating...\r\n              </span>\r\n              <span v-else>\r\n                <i class=\"fas fa-tv mr-2\"></i>\r\n                Activate Device\r\n              </span>\r\n            </button>\r\n\r\n            <!-- Error Message -->\r\n            <div v-if=\"errorMessage\" class=\"p-4 bg-red-500/10 border border-red-500/30 rounded-xl\">\r\n              <div class=\"flex items-center gap-2 text-red-400\">\r\n                <i class=\"fas fa-exclamation-circle\"></i>\r\n                <span>{{ errorMessage }}</span>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Success Message -->\r\n            <div v-if=\"successMessage\" class=\"p-4 bg-green-500/10 border border-green-500/30 rounded-xl\">\r\n              <div class=\"flex items-center gap-2 text-green-400\">\r\n                <i class=\"fas fa-check-circle\"></i>\r\n                <span>{{ successMessage }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Instructions -->\r\n        <div class=\"mt-12 max-w-3xl mx-auto\">\r\n          <h2 class=\"text-2xl font-bold text-center mb-8\">How to Activate</h2>\r\n          <div class=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n            <div class=\"bg-[#1a1a1a]/50 border border-white/10 rounded-2xl p-6 text-center\">\r\n              <div class=\"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-[#c30059] to-[#ff6b9d] rounded-2xl flex items-center justify-center\">\r\n                <span class=\"text-2xl font-bold text-white\">1</span>\r\n              </div>\r\n              <h3 class=\"text-lg font-bold mb-2\">Open App on TV</h3>\r\n              <p class=\"text-white/60 text-sm\">\r\n                Launch the OTT TV app on your smart TV or streaming device\r\n              </p>\r\n            </div>\r\n            \r\n            <div class=\"bg-[#1a1a1a]/50 border border-white/10 rounded-2xl p-6 text-center\">\r\n              <div class=\"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-[#c30059] to-[#ff6b9d] rounded-2xl flex items-center justify-center\">\r\n                <span class=\"text-2xl font-bold text-white\">2</span>\r\n              </div>\r\n              <h3 class=\"text-lg font-bold mb-2\">Get Activation Code</h3>\r\n              <p class=\"text-white/60 text-sm\">\r\n                Note the 8-character code displayed on your TV screen\r\n              </p>\r\n            </div>\r\n            \r\n            <div class=\"bg-[#1a1a1a]/50 border border-white/10 rounded-2xl p-6 text-center\">\r\n              <div class=\"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-[#c30059] to-[#ff6b9d] rounded-2xl flex items-center justify-center\">\r\n                <span class=\"text-2xl font-bold text-white\">3</span>\r\n              </div>\r\n              <h3 class=\"text-lg font-bold mb-2\">Enter Code Here</h3>\r\n              <p class=\"text-white/60 text-sm\">\r\n                Type the code above and click Activate Device\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useStore } from 'vuex';\r\nimport { ref, computed, onMounted } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  name: 'DeviceActivation',\r\n  setup() {\r\n    const store = useStore();\r\n    const router = useRouter();\r\n    \r\n    const activationCode = ref('');\r\n    const isActivating = ref(false);\r\n    const errorMessage = ref('');\r\n    const successMessage = ref('');\r\n    \r\n    // Computed properties from store\r\n    const isAuthenticated = computed(() => store.getters.isAuthenticated);\r\n    const user = computed(() => store.getters.currentUser);\r\n    const token = computed(() => store.getters.token);\r\n    \r\n    // Format activation code (uppercase, remove spaces)\r\n    const formatCode = () => {\r\n      activationCode.value = activationCode.value\r\n        .toUpperCase()\r\n        .replace(/[^A-Z0-9]/g, '')\r\n        .slice(0, 8);\r\n    };\r\n    \r\n    // Activate device\r\n    const activateDevice = async () => {\r\n      if (!isAuthenticated.value || !activationCode.value || activationCode.value.length !== 8) {\r\n        return;\r\n      }\r\n      \r\n      isActivating.value = true;\r\n      errorMessage.value = '';\r\n      successMessage.value = '';\r\n      \r\n      try {\r\n        // Set authorization header\r\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token.value}`;\r\n        \r\n        // Call activation API\r\n        const response = await axios.post('/users/api/device-activation/', {\r\n          activation_code: activationCode.value,\r\n          device_id: `web_${Date.now()}`, // Generate a temporary device ID\r\n          device_name: 'Web Activation',\r\n          device_type: 'web',\r\n          phone: user.value.phone\r\n        });\r\n        \r\n        if (response.data.status === 'success') {\r\n          successMessage.value = 'Device activated successfully! Your TV should now have access to premium content.';\r\n          \r\n          // Show success toast\r\n          store.dispatch('showToast', {\r\n            message: 'Device activated successfully!',\r\n            type: 'success'\r\n          });\r\n          \r\n          // Redirect to profile after a delay\r\n          setTimeout(() => {\r\n            router.push('/profile');\r\n          }, 3000);\r\n        } else {\r\n          throw new Error(response.data.message || 'Failed to activate device');\r\n        }\r\n      } catch (error) {\r\n        console.error('Activation error:', error);\r\n        errorMessage.value = error.response?.data?.message || 'Failed to activate device. Please try again.';\r\n        \r\n        // Show error toast\r\n        store.dispatch('showToast', {\r\n          message: errorMessage.value,\r\n          type: 'error'\r\n        });\r\n      } finally {\r\n        isActivating.value = false;\r\n      }\r\n    };\r\n    \r\n    // Check for code in URL parameters\r\n    onMounted(() => {\r\n      const urlParams = new URLSearchParams(window.location.search);\r\n      const code = urlParams.get('code');\r\n      if (code) {\r\n        activationCode.value = code;\r\n        formatCode();\r\n      }\r\n    });\r\n    \r\n    return {\r\n      activationCode,\r\n      isActivating,\r\n      errorMessage,\r\n      successMessage,\r\n      isAuthenticated,\r\n      user,\r\n      formatCode,\r\n      activateDevice\r\n    };\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* Add any component-specific styles here */\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}