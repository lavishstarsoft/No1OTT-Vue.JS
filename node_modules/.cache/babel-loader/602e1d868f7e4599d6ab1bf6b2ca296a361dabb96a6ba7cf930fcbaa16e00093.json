{"ast":null,"code":"import popupManager from '@/utils/popupManager.js';\nexport default {\n  name: 'PopupModal',\n  data() {\n    return {\n      showPopup: false,\n      popupConfig: {\n        showPopup: false,\n        popupContent: {},\n        popupSettings: {}\n      },\n      imageError: false,\n      hasShownPopup: false,\n      currentDevice: 'desktop'\n    };\n  },\n  async mounted() {\n    this.detectDevice();\n    await this.loadPopupConfig();\n    this.checkAndShowPopup();\n  },\n  computed: {\n    shouldShowOnThisPage() {\n      const pages = this.popupConfig.popupSettings?.showOnPages;\n      // If showOnPages not set, show everywhere. Else, only show if current route name is in array.\n      return !pages || pages.includes(this.$route?.name);\n    }\n  },\n  watch: {\n    showPopup(newVal) {\n      if (newVal) {\n        document.body.style.overflow = 'hidden';\n      } else {\n        document.body.style.overflow = '';\n      }\n    }\n  },\n  beforeUnmount() {\n    document.body.style.overflow = '';\n  },\n  methods: {\n    async loadPopupConfig() {\n      try {\n        this.popupConfig = await popupManager.loadConfig();\n      } catch (error) {\n        console.error('Error loading popup config:', error);\n        this.popupConfig = popupManager.getDefaultConfig();\n      }\n    },\n    detectDevice() {\n      this.currentDevice = popupManager.isMobileDevice() ? 'mobile' : 'desktop';\n      console.log('Current device detected:', this.currentDevice);\n    },\n    checkAndShowPopup() {\n      if (popupManager.shouldShowPopup()) {\n        const delay = popupManager.getPopupDelay();\n        setTimeout(() => {\n          this.showPopup = true;\n          this.hasShownPopup = true;\n          this.playPopupSound(); // Play sound when popup opens\n        }, delay);\n      } else {\n        console.log('Popup not shown. Device type:', this.currentDevice, 'Config device type:', this.popupConfig.popupSettings?.deviceType);\n      }\n    },\n    playPopupSound() {\n      const url = this.popupConfig.popupContent?.soundUrl;\n      if (url) {\n        const audio = new Audio(url);\n        audio.play();\n      }\n    },\n    closePopup() {\n      this.showPopup = false;\n      popupManager.markPopupAsShown();\n    },\n    handleAction() {\n      this.closePopup();\n      this.$emit('popup-action');\n    },\n    handleImageError() {\n      this.imageError = true;\n    },\n    showPopupManually() {\n      this.showPopup = true;\n    },\n    resetPopup() {\n      popupManager.resetPopupState();\n      this.hasShownPopup = false;\n      this.showPopup = false;\n    }\n  }\n};","map":{"version":3,"names":["popupManager","name","data","showPopup","popupConfig","popupContent","popupSettings","imageError","hasShownPopup","currentDevice","mounted","detectDevice","loadPopupConfig","checkAndShowPopup","computed","shouldShowOnThisPage","pages","showOnPages","includes","$route","watch","newVal","document","body","style","overflow","beforeUnmount","methods","loadConfig","error","console","getDefaultConfig","isMobileDevice","log","shouldShowPopup","delay","getPopupDelay","setTimeout","playPopupSound","deviceType","url","soundUrl","audio","Audio","play","closePopup","markPopupAsShown","handleAction","$emit","handleImageError","showPopupManually","resetPopup","resetPopupState"],"sources":["F:\\OTT\\ott_frontend\\src\\components\\PopupModal.vue"],"sourcesContent":["<template>\n  <div v-if=\"shouldShowOnThisPage && showPopup\" class=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n    <!-- Simple dark overlay -->\n    <div \n      class=\"absolute inset-0 bg-[#000000E8] bg-opacity-95\"\n      @click=\"closePopup\"\n    ></div>\n    \n    <!-- Popup card with plain background -->\n    <div \n      class=\"relative w-auto h-auto max-w-full max-h-full transform transition-all duration-300 scale-100 rounded-xl p-0\"\n      :class=\"{'scale-100 opacity-100': showPopup, 'scale-95 opacity-0': !showPopup}\"\n    >\n      <!-- Minimal close button -->\n      <button \n        v-if=\"popupConfig.popupSettings?.dismissible\"\n        @click=\"closePopup\"\n        class=\"absolute -top-6 right-5 w-10 h-10 rounded-full bg-white flex items-center justify-center hover:bg-gray-100 transition-colors duration-200\"\n        title=\"Close popup\"\n        aria-label=\"Close popup\"\n        style=\"margin-left: 8%\"\n         >\n        <svg class=\"w-5 h-5 text-gray-800\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2.5\">\n          <path d=\"M6 6l12 12M6 18L18 6\" stroke-linecap=\"round\" />\n        </svg>\n      </button>\n      <!-- Content with Android modal style -->\n      <div class=\"p-0 flex flex-col items-center justify-center\">\n        <!-- Image at the top center if available -->\n        <div v-if=\"popupConfig.popupContent?.imageUrl && !imageError\" class=\"flex justify-center mb-4 mt-2\">\n          <img \n            :src=\"popupConfig.popupContent.imageUrl\" \n            :alt=\"popupConfig.popupContent.title\" \n            :style=\"{\n              width: typeof popupConfig.popupContent.imageWidth === 'string'\n                ? popupConfig.popupContent.imageWidth\n                : (popupConfig.popupContent.imageWidth || 80) + 'px',\n              height: typeof popupConfig.popupContent.imageHeight === 'string'\n                ? popupConfig.popupContent.imageHeight\n                : (popupConfig.popupContent.imageHeight || 80) + 'px'\n            }\"\n            class=\"object-cover rounded-none max-w-full h-auto\" \n            @error=\"handleImageError\" \n          />\n        </div>\n        <!-- Title with mixed typography -->\n        <h2 v-if=\"popupConfig.popupContent?.title\" class=\"text-center mb-4\">\n          <span class=\"block text-3xl font-light tracking-wide text-white mb-1\">{{ popupConfig.popupContent.title.split(' ')[0] }}</span>\n          <span class=\"block text-3xl font-black italic text-white\" style=\"font-family: 'Arial Black', sans-serif;\">{{ popupConfig.popupContent.title.split(' ').slice(1).join(' ') }}</span>\n        </h2>\n        <!-- Clean message text -->\n        <p v-if=\"popupConfig.popupContent?.message\" class=\"text-white/90 text-center mb-6 text-base leading-relaxed\">\n          {{ popupConfig.popupContent.message }}\n        </p>\n        <!-- Simple action buttons -->\n        <div class=\"flex flex-col gap-3 w-full\">\n          <button \n            v-if=\"popupConfig.popupContent?.buttonText\"\n            @click=\"handleAction\"\n            class=\"w-full bg-white text-indigo-700 py-3 rounded-lg font-semibold text-base hover:bg-gray-100 transition-colors duration-200 shadow\"\n          >\n            {{ popupConfig.popupContent.buttonText }}\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport popupManager from '@/utils/popupManager.js';\n\nexport default {\n  name: 'PopupModal',\n  data() {\n    return {\n      showPopup: false,\n      popupConfig: {\n        showPopup: false,\n        popupContent: {},\n        popupSettings: {}\n      },\n      imageError: false,\n      hasShownPopup: false,\n      currentDevice: 'desktop'\n    }\n  },\n  async mounted() {\n    this.detectDevice();\n    await this.loadPopupConfig();\n    this.checkAndShowPopup();\n  },\n  computed: {\n    shouldShowOnThisPage() {\n      const pages = this.popupConfig.popupSettings?.showOnPages;\n      // If showOnPages not set, show everywhere. Else, only show if current route name is in array.\n      return !pages || pages.includes(this.$route?.name);\n    }\n  },\n  watch: {\n    showPopup(newVal) {\n      if (newVal) {\n        document.body.style.overflow = 'hidden';\n      } else {\n        document.body.style.overflow = '';\n      }\n    }\n  },\n  beforeUnmount() {\n    document.body.style.overflow = '';\n  },\n  methods: {\n    async loadPopupConfig() {\n      try {\n        this.popupConfig = await popupManager.loadConfig();\n      } catch (error) {\n        console.error('Error loading popup config:', error);\n        this.popupConfig = popupManager.getDefaultConfig();\n      }\n    },\n    detectDevice() {\n      this.currentDevice = popupManager.isMobileDevice() ? 'mobile' : 'desktop';\n      console.log('Current device detected:', this.currentDevice);\n    },\n    checkAndShowPopup() {\n      if (popupManager.shouldShowPopup()) {\n        const delay = popupManager.getPopupDelay();\n        setTimeout(() => {\n          this.showPopup = true;\n          this.hasShownPopup = true;\n          this.playPopupSound(); // Play sound when popup opens\n        }, delay);\n      } else {\n        console.log('Popup not shown. Device type:', this.currentDevice, 'Config device type:', this.popupConfig.popupSettings?.deviceType);\n      }\n    },\n    playPopupSound() {\n      const url = this.popupConfig.popupContent?.soundUrl;\n      if (url) {\n        const audio = new Audio(url);\n        audio.play();\n      }\n    },\n    closePopup() {\n      this.showPopup = false;\n      popupManager.markPopupAsShown();\n    },\n    handleAction() {\n      this.closePopup();\n      this.$emit('popup-action');\n    },\n    handleImageError() {\n      this.imageError = true;\n    },\n    showPopupManually() {\n      this.showPopup = true;\n    },\n    resetPopup() {\n      popupManager.resetPopupState();\n      this.hasShownPopup = false;\n      this.showPopup = false;\n    }\n  }\n}\n</script>\n\n<style scoped>\n/* Simple animations */\n.popup-enter-active, .popup-leave-active {\n  transition: all 0.3s ease;\n}\n\n.popup-enter-from, .popup-leave-to {\n  opacity: 0;\n  transform: scale(0.95);\n}\n\n/* Clean button focus state */\nbutton:focus-visible {\n  outline: 2px solid #000000FF;\n  outline-offset: 2px;\n}\n\n/* Simple hover effect */\nbutton {\n  position: relative;\n  overflow: hidden;\n}\n\n/* Responsive adjustments */\n@media (max-width: 640px) {\n  .popup-container {\n    margin: 1rem;\n  }\n  \n  h2 {\n    font-size: 1.75rem;\n  }\n  \n  p {\n    font-size: 1rem;\n  }\n}\n\n/* Android style shadow */\n.shadow-2xl {\n  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}