{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport AppHeader from '../components/Header.vue';\nimport AppFooter from '../components/Footer.vue';\nimport AdvancedVideoPlayer from '../components/AdvancedVideoPlayer.vue';\nimport axios from 'axios';\nimport { watchlistAPI } from '@/utils/api';\nimport videojs from 'video.js';\nimport 'video.js/dist/video-js.css';\nimport store from '@/store';\n\n// Define API base URL constant\nconst API_BASE_URL = 'https://admin.no1ott.com';\n\n// Create axios instance with default config\nconst axiosInstance = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Add request interceptor to add token\naxiosInstance.interceptors.request.use(config => {\n  const token = store.getters.token;\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\nexport default {\n  name: 'MovieDetails',\n  components: {\n    AppHeader,\n    AppFooter,\n    AdvancedVideoPlayer\n  },\n  props: {\n    id: {\n      type: [Number, String],\n      required: true\n    }\n  },\n  data() {\n    return {\n      movie: {},\n      inWatchlist: false,\n      isSearchActive: false,\n      isVideoPlaying: false,\n      controlsVisible: true,\n      isVideoPaused: false,\n      controlsTimeout: null,\n      isMobileDevice: false,\n      videoInteractionDelay: 2500,\n      videoUrl: '',\n      streamType: 'hls',\n      isUserSubscribed: false,\n      promoStartDelay: 3000,\n      // 3 seconds delay before starting promo\n      drmConfig: {\n        // DRM configuration if needed\n        // Example for Widevine:\n        servers: {\n          'com.widevine.alpha': 'https://license.url/widevine'\n        },\n        // Example for Clear Key:\n        clearKeys: {\n          // keyId: 'key' pairs\n        }\n      },\n      playerSettings: {\n        defaultQuality: 'auto',\n        preferredQualityIndex: 1,\n        skipInterval: 10,\n        // seconds\n        keyboardShortcutsEnabled: true,\n        rememberLastPosition: true,\n        autoQualitySwitch: true\n      },\n      canScrollLeft: {\n        category: false,\n        related: false,\n        recentlyAdded: false\n      },\n      canScrollRight: {\n        category: true,\n        related: true,\n        recentlyAdded: true\n      },\n      categoryVideos: [],\n      recentlyAddedVideos: [],\n      relatedMovies: [{\n        id: 101,\n        title: 'Midnight Mystery',\n        thumbnail_url: 'https://i.ibb.co/cDfWsvC/related1.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/cDfWsvC/related1.jpg',\n        video_type: 'free'\n      }, {\n        id: 102,\n        title: 'The Stranger',\n        thumbnail_url: 'https://i.ibb.co/DkFnm7g/related2.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/DkFnm7g/related2.jpg',\n        video_type: 'paid'\n      }, {\n        id: 103,\n        title: 'Dark Echo',\n        thumbnail_url: 'https://i.ibb.co/MRVvFDZ/related3.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/MRVvFDZ/related3.jpg',\n        video_type: 'free'\n      }, {\n        id: 104,\n        title: 'Silent Night',\n        thumbnail_url: 'https://i.ibb.co/5cG2WXF/related4.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/5cG2WXF/related4.jpg',\n        video_type: 'rental'\n      }, {\n        id: 105,\n        title: 'The Guilty',\n        thumbnail_url: 'https://i.ibb.co/mBVR2KM/related5.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/mBVR2KM/related5.jpg',\n        video_type: 'free'\n      }, {\n        id: 106,\n        title: 'Trance',\n        thumbnail_url: 'https://i.ibb.co/hWD1BXg/related6.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/hWD1BXg/related6.jpg',\n        video_type: 'paid'\n      }, {\n        id: 107,\n        title: 'Haunted House',\n        thumbnail_url: 'https://i.ibb.co/k8DQzTF/related7.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/k8DQzTF/related7.jpg',\n        video_type: 'free'\n      }, {\n        id: 108,\n        title: 'Night Watch',\n        thumbnail_url: 'https://i.ibb.co/hyCJTBL/related8.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/hyCJTBL/related8.jpg',\n        video_type: 'rental'\n      }, {\n        id: 109,\n        title: 'The Missing',\n        thumbnail_url: 'https://i.ibb.co/dj8rS0M/related9.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/dj8rS0M/related9.jpg',\n        video_type: 'free'\n      }, {\n        id: 110,\n        title: 'Fear Factor',\n        thumbnail_url: 'https://i.ibb.co/8XvX1fL/related10.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/8XvX1fL/related10.jpg',\n        video_type: 'paid'\n      }, {\n        id: 111,\n        title: 'Paranormal',\n        thumbnail_url: 'https://i.ibb.co/r57Kzc5/related11.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/r57Kzc5/related11.jpg',\n        video_type: 'free'\n      }, {\n        id: 112,\n        title: 'Last Breath',\n        thumbnail_url: 'https://i.ibb.co/B6wS7HK/related12.jpg',\n        portrait_thumbnail_url: 'https://i.ibb.co/B6wS7HK/related12.jpg',\n        video_type: 'rental'\n      }],\n      heroVideo: null,\n      hls: null,\n      showPaymentPopup: false,\n      userSubscriptionStatus: null,\n      showRentalPopup: false,\n      rentalInfo: null,\n      isSubscribed: false,\n      isPromoLoading: true,\n      promoVideoError: null,\n      isPlayingPromo: false,\n      isInWatchlist: false,\n      showShareDialog: false,\n      copyStatus: 'Copy',\n      promoHasError: false,\n      videojsPlayer: null,\n      isPromoPlaying: false\n    };\n  },\n  computed: {\n    // Get current user ID from localStorage\n    currentUserId() {\n      const user = localStorage.getItem('user');\n      if (user) {\n        try {\n          const userData = JSON.parse(user);\n          return userData.id || 1; // Default to 1 if no user ID\n        } catch (e) {\n          return 1; // Default to 1 if parsing fails\n        }\n      }\n      return 1; // Default to 1 if no user data\n    },\n    // Get the appropriate stream type based on the video URL or device capabilities\n    computedStreamType() {\n      // Check if the URL ends with specific extensions\n      if (this.videoUrl.includes('.m3u8')) {\n        return 'hls';\n      } else if (this.videoUrl.includes('.mpd')) {\n        return 'dash';\n      } else if (this.videoUrl.includes('.mp4')) {\n        // Explicitly handle MP4 files\n        return 'mp4';\n      }\n      // Default fallback\n      return 'mp4';\n    },\n    // Get the year from created_at\n    movieYear() {\n      if (this.movie && this.movie.created_at) {\n        return new Date(this.movie.created_at).getFullYear();\n      }\n      return new Date().getFullYear(); // Fallback to current year\n    },\n    // Format duration from seconds to hours and minutes\n    formattedDuration() {\n      if (!this.movie || !this.movie.duration) return '';\n      const totalSeconds = parseInt(this.movie.duration);\n      if (isNaN(totalSeconds)) return '';\n      const hours = Math.floor(totalSeconds / 3600);\n      const minutes = Math.floor(totalSeconds % 3600 / 60);\n      if (hours === 0) {\n        return `${minutes}m`;\n      } else if (minutes === 0) {\n        return `${hours}h`;\n      } else {\n        return `${hours}h ${minutes}m`;\n      }\n    },\n    // Get category name\n    categoryName() {\n      if (!this.movie) return '';\n      return this.movie.category_name || ''; // Directly use category_name from API\n    },\n    // Get formatted categories\n    formattedCategories() {\n      if (!this.movie || !this.movie.categories) return '';\n      return this.movie.categories.map(cat => cat.name).join(', ');\n    },\n    shareUrl() {\n      if (typeof window !== 'undefined') {\n        return window.location.href;\n      }\n      return '';\n    },\n    // Check if promo button should be shown\n    shouldShowPromoButton() {\n      return this.movie && this.movie.promo_hls_url && this.movie.promo_hls_url.trim() !== '' && !this.promoHasError;\n    }\n  },\n  watch: {\n    // Watch for route changes to reset scroll position when navigating between movie details pages\n    '$route'() {\n      window.scrollTo(0, 0);\n      this.fetchMovieDetails().then(() => {\n        // Initialize hero video after fetching new movie details\n        this.$nextTick(() => {\n          this.initializeHeroVideo();\n        });\n      });\n    },\n    // Update stream type based on the video URL\n    videoUrl: {\n      immediate: true,\n      handler(newUrl) {\n        // Update stream type based on the new URL\n        if (newUrl) {\n          this.streamType = this.computedStreamType;\n        }\n      }\n    },\n    // Add watcher for movie data\n    movie: {\n      immediate: true,\n      handler(newMovie) {\n        if (newMovie && (newMovie.promo_hls_url || newMovie.promo_video_url)) {\n          this.$nextTick(() => {\n            this.initializeHeroVideo();\n          });\n        }\n\n        // Update meta tags when movie data changes\n        if (newMovie) {\n          this.$nextTick(() => {\n            this.updateMetaTags();\n          });\n        }\n      }\n    },\n    // Debug watcher for isPromoPlaying\n    isPromoPlaying(val) {\n      console.log('isPromoPlaying changed:', val);\n    }\n  },\n  mounted() {\n    // Initialize hero video with HLS\n    this.initializeHeroVideo();\n    this.$nextTick(() => {\n      this.checkScrollButtons('categoryContainer', 'category');\n      this.checkScrollButtons('relatedContainer', 'related');\n      this.checkScrollButtons('recentlyAddedContainer', 'recentlyAdded');\n\n      // Check if mobile device\n      this.checkDeviceType();\n\n      // Listen for resize events to update device type\n      window.addEventListener('resize', this.checkDeviceType);\n\n      // Add scroll event listener for header background\n      window.addEventListener('scroll', this.handleScroll);\n\n      // Update meta tags after component is mounted\n      if (this.movie) {\n        this.updateMetaTags();\n      }\n    });\n  },\n  beforeUnmount() {\n    // Clean up HLS instance\n    if (this.hls) {\n      this.hls.destroy();\n    }\n\n    // Clean up resize listener\n    window.removeEventListener('resize', this.checkDeviceType);\n\n    // Clean up scroll listener\n    window.removeEventListener('scroll', this.handleScroll);\n\n    // Clear any active control timeouts\n    if (this.controlsTimeout) {\n      clearTimeout(this.controlsTimeout);\n    }\n    if (this.videojsPlayer) {\n      this.videojsPlayer.dispose();\n      this.videojsPlayer = null;\n    }\n  },\n  created() {\n    // Get video URL from route params if available\n    if (this.$route.params.videoUrl) {\n      this.videoUrl = this.$route.params.videoUrl;\n      this.streamType = this.$route.params.videoType || 'hls';\n    }\n\n    // Check subscription status\n    this.checkUserSubscription().then(isSubscribed => {\n      this.isUserSubscribed = isSubscribed;\n    });\n\n    // Fetch movie details\n    this.fetchMovieDetails();\n\n    // Load any saved player preferences from localStorage\n    this.loadPlayerPreferences();\n    this.checkWatchlistStatus();\n  },\n  methods: {\n    formatWatchPeriod(days) {\n      if (!days) return '';\n      return `${days} ${days === 1 ? 'day' : 'days'}`;\n    },\n    loadPlayerPreferences() {\n      // Load user preferences from localStorage\n      const savedPreferences = localStorage.getItem('player-preferences');\n      if (savedPreferences) {\n        try {\n          const preferences = JSON.parse(savedPreferences);\n          // Apply only the properties that exist in our settings object\n          Object.keys(this.playerSettings).forEach(key => {\n            if (preferences[key] !== undefined) {\n              this.playerSettings[key] = preferences[key];\n            }\n          });\n        } catch (e) {\n          console.error('Error parsing saved player preferences', e);\n        }\n      }\n    },\n    savePlayerPreferences() {\n      // Save current player settings to localStorage\n      localStorage.setItem('player-preferences', JSON.stringify(this.playerSettings));\n    },\n    initializeHeroVideo() {\n      const video = this.$refs.heroVideo;\n      if (!video) {\n        console.error('Video element not found');\n        return;\n      }\n      const videoSrc = this.movie.promo_hls_url || this.movie.video_url;\n      if (!videoSrc || !videoSrc.includes('.m3u8')) {\n        console.error('Invalid or missing HLS URL');\n        return;\n      }\n      // Dispose previous player if exists\n      if (this.videojsPlayer) {\n        this.videojsPlayer.dispose();\n      }\n      // Ensure video is muted for autoplay\n      video.muted = true;\n      this.videojsPlayer = videojs(video, {\n        sources: [{\n          src: videoSrc,\n          type: 'application/x-mpegURL'\n        }],\n        controls: true,\n        autoplay: true,\n        // Enable autoplay\n        muted: true,\n        // Ensure muted for autoplay\n        preload: 'auto',\n        fluid: true\n      });\n      this.videojsPlayer.ready(() => {\n        this.isPromoLoading = false;\n        this.videojsPlayer.muted(true); // Ensure muted\n        this.videojsPlayer.play().catch(e => {\n          console.error('Auto-play prevented:', e);\n        });\n      });\n      this.videojsPlayer.on('error', () => {\n        this.promoVideoError = this.videojsPlayer.error();\n        console.error('Video.js error:', this.promoVideoError);\n      });\n    },\n    onPromoVideoCanPlay() {\n      console.log('Video can play');\n      const video = this.$refs.heroVideo;\n      if (video) {\n        video.play().catch(error => {\n          console.error('Play failed:', error);\n        });\n      }\n    },\n    onPromoVideoLoaded() {\n      console.log('Promo video loaded successfully');\n      this.isPromoLoading = false;\n      const video = this.$refs.heroVideo;\n      if (video) {\n        video.classList.add('playing');\n        // Ensure video is muted and playing\n        video.muted = true;\n        video.play().catch(error => {\n          console.error('Play failed:', error);\n        });\n      }\n    },\n    onPromoVideoWaiting() {\n      console.log('Promo video waiting/buffering');\n      this.isPromoLoading = true;\n    },\n    onPromoVideoPlaying() {\n      this.isPromoPlaying = true;\n      this.isPromoLoading = false;\n      const video = this.$refs.heroVideo;\n      if (video) {\n        video.classList.add('playing');\n      }\n    },\n    handlePromoVideoError(error) {\n      console.error('Promo video error:', error);\n      this.promoVideoError = error;\n      const video = this.$refs.heroVideo;\n      if (video) {\n        video.classList.remove('playing');\n      }\n    },\n    async checkUserSubscription() {\n      try {\n        const phone = localStorage.getItem('phone');\n        if (!phone) return false;\n        const response = await axios.get(`${API_BASE_URL}/users/profile/?phone=${phone}`);\n        console.log('Subscription API response:', response.data); // DEBUG\n        if (response.data && response.data.status === 'success') {\n          const user = response.data.user;\n          console.log('User from API:', user); // DEBUG\n          // Check if user has active subscription\n          if (user.is_subscribed && user.subscription_end_date) {\n            const endDate = new Date(user.subscription_end_date);\n            const now = new Date();\n            const isActive = endDate > now;\n            console.log('is_subscribed:', user.is_subscribed, 'endDate:', endDate, 'now:', now, 'isActive:', isActive); // DEBUG\n            return isActive;\n          }\n        }\n        return false;\n      } catch (error) {\n        console.error('Error checking subscription:', error);\n        return false;\n      }\n    },\n    async checkRentalStatus() {\n      try {\n        const phone = localStorage.getItem('phone');\n        if (!phone) return null;\n        const response = await axios.get(`${API_BASE_URL}/api/rentals/check/?phone=${phone}&video_id=${this.movie.id}`);\n        if (response.data && response.data.status === 'success') {\n          return response.data.rental;\n        }\n        return null;\n      } catch (error) {\n        console.error('Error checking rental status:', error);\n        return null;\n      }\n    },\n    goToRentalPayment() {\n      this.showRentalPopup = false;\n      this.$router.push(`/movie/${this.movie.id}/rent`);\n    },\n    async playMovie() {\n      try {\n        console.log('playMovie() called - checking video URL');\n        // First check if we have a valid video URL\n        if (!this.movie.hls_url) {\n          throw new Error('No video URL available');\n        }\n\n        // Check user subscription status first\n        const isSubscribed = await this.checkUserSubscription();\n        console.log('User subscription status:', isSubscribed);\n\n        // Rental video logic\n        if (this.movie.video_type === 'rental') {\n          if (isSubscribed) {\n            // Premium user: play directly without showing rental popup\n            console.log('Premium user - playing directly');\n            this.controlsVisible = true;\n            this.isVideoPaused = false;\n            this.isVideoPlaying = true;\n            this.videoUrl = this.movie.hls_url;\n            this.streamType = 'hls';\n            document.body.style.overflow = 'hidden';\n            this.$nextTick(() => {\n              if (this.$refs.videoPlayer) {\n                this.resetControlsTimer();\n              } else {\n                console.error('Video player reference not found');\n                throw new Error('Video player initialization failed');\n              }\n            });\n          } else {\n            // Free user: check rental status\n            console.log('Free user - checking rental status');\n            const rentalInfo = await this.checkRentalStatus();\n            if (rentalInfo && rentalInfo.is_active) {\n              // Rental is active, allow playback\n              console.log('Active rental found - playing video');\n              this.controlsVisible = true;\n              this.isVideoPaused = false;\n              this.isVideoPlaying = true;\n              this.videoUrl = this.movie.hls_url;\n              this.streamType = 'hls';\n              document.body.style.overflow = 'hidden';\n              this.$nextTick(() => {\n                if (this.$refs.videoPlayer) {\n                  this.resetControlsTimer();\n                } else {\n                  console.error('Video player reference not found');\n                  throw new Error('Video player initialization failed');\n                }\n              });\n            } else {\n              // No active rental, redirect to rental page\n              console.log('No active rental - redirecting to rental page');\n              this.$router.push(`/movie/${this.movie.id}/rent`);\n            }\n          }\n          return;\n        }\n\n        // Paid video logic\n        if (this.movie.video_type === 'paid') {\n          if (!isSubscribed) {\n            // If not subscribed, redirect to subscription page\n            this.$router.push({\n              name: 'SubscriptionPlans',\n              query: {\n                redirect: this.$route.fullPath,\n                video_id: this.movie.id\n              }\n            });\n            return;\n          }\n        }\n\n        // Free video or user is subscribed, proceed with playback\n        console.log('Playing free/paid video');\n        this.controlsVisible = true;\n        this.isVideoPaused = false;\n        this.isVideoPlaying = true;\n        this.videoUrl = this.movie.hls_url;\n        this.streamType = 'hls';\n        document.body.style.overflow = 'hidden';\n        this.$nextTick(() => {\n          if (this.$refs.videoPlayer) {\n            this.resetControlsTimer();\n          } else {\n            console.error('Video player reference not found');\n            throw new Error('Video player initialization failed');\n          }\n        });\n      } catch (error) {\n        console.error('Error playing video:', error);\n        this.$store.dispatch('showToast', {\n          message: 'Sorry, the video is not available at the moment. Please try again later.',\n          type: 'error'\n        });\n        this.isVideoPlaying = false;\n        document.body.style.overflow = 'auto';\n      }\n    },\n    closeVideo() {\n      this.isVideoPlaying = false;\n      this.isPlayingPromo = false;\n\n      // Save the player preferences when closing the player\n      this.savePlayerPreferences();\n\n      // Restore body scrolling\n      document.body.style.overflow = '';\n    },\n    async toggleWatchlist() {\n      try {\n        // Get authentication state from localStorage\n        const isAuthenticated = localStorage.getItem('isAuthenticated') === 'true';\n        const token = localStorage.getItem('token');\n        if (!isAuthenticated || !token) {\n          // Store current path for redirect after login\n          const currentPath = this.$route.fullPath;\n          // Redirect to login with return URL\n          this.$router.push({\n            path: '/login',\n            query: {\n              redirect: currentPath\n            }\n          });\n          return;\n        }\n\n        // Show loading state\n        this.$store.commit('setLoading', true);\n        const response = await watchlistAPI.toggle(this.id);\n        if (response.data.status === 'success') {\n          this.isInWatchlist = response.data.in_watchlist;\n          // Show success message\n          this.$store.dispatch('showToast', {\n            message: response.data.message,\n            type: 'success'\n          });\n        }\n      } catch (error) {\n        console.error('Error toggling watchlist:', error);\n        // Show error message\n        this.$store.dispatch('showToast', {\n          message: 'Failed to update watchlist. Please try again.',\n          type: 'error'\n        });\n      } finally {\n        this.$store.commit('setLoading', false);\n      }\n    },\n    async checkWatchlistStatus() {\n      try {\n        // Check authentication from localStorage\n        const isAuthenticated = localStorage.getItem('isAuthenticated') === 'true';\n        const token = localStorage.getItem('token');\n        if (!isAuthenticated || !token) return;\n        const response = await watchlistAPI.getStatus(this.id);\n        this.isInWatchlist = response.data.in_watchlist;\n      } catch (error) {\n        console.error('Error checking watchlist status:', error);\n      }\n    },\n    shareMovie() {\n      // Get the current URL for sharing \n      const shareUrl = this.shareUrl;\n\n      // Get the best available image URL\n      const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n\n      // Prepare share data with image\n      const shareData = {\n        title: this.movie.title,\n        text: this.movie.description,\n        url: shareUrl\n      };\n\n      // Add image to share data if available\n      if (imageUrl) {\n        shareData.files = [imageUrl];\n      }\n\n      // Check if Web Share API is supported\n      if (typeof navigator !== 'undefined' && navigator.share && this.isMobileDevice) {\n        // For mobile devices, try to share with image\n        if (imageUrl && navigator.canShare && navigator.canShare(shareData)) {\n          navigator.share(shareData).then(() => {\n            this.$store.dispatch('showToast', {\n              message: 'Shared successfully with image!',\n              type: 'success'\n            });\n          }).catch(error => {\n            console.error('Error sharing with image:', error);\n            // Fallback to sharing without image\n            this.shareWithoutImage(shareUrl);\n          });\n        } else {\n          // Fallback to sharing without image\n          this.shareWithoutImage(this.shareUrl);\n        }\n      } else {\n        // Fallback for desktop or unsupported browsers\n        this.showShareDialog = true;\n      }\n    },\n    shareWithoutImage(shareUrl) {\n      const shareData = {\n        title: this.movie.title,\n        text: this.movie.description,\n        url: shareUrl\n      };\n      navigator.share(shareData).then(() => {\n        this.$store.dispatch('showToast', {\n          message: 'Shared successfully!',\n          type: 'success'\n        });\n      }).catch(error => {\n        console.error('Error sharing:', error);\n        this.showShareDialog = true;\n      });\n    },\n    updateMetaTags() {\n      if (!this.movie) return;\n      const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n      const shareUrl = this.shareUrl;\n      const title = this.movie.title;\n      const description = this.movie.description;\n\n      // Update or create meta tags for Open Graph\n      this.updateMetaTag('og:title', title);\n      this.updateMetaTag('og:description', description);\n      this.updateMetaTag('og:image', imageUrl);\n      this.updateMetaTag('og:url', shareUrl);\n      this.updateMetaTag('og:type', 'video.movie');\n      this.updateMetaTag('og:site_name', 'No1 OTT');\n\n      // Update or create meta tags for Twitter Card\n      this.updateMetaTag('twitter:card', 'summary_large_image');\n      this.updateMetaTag('twitter:title', title);\n      this.updateMetaTag('twitter:description', description);\n      this.updateMetaTag('twitter:image', imageUrl);\n      this.updateMetaTag('twitter:url', shareUrl);\n\n      // Update page title\n      document.title = `${title} - No1 OTT`;\n    },\n    updateMetaTag(name, content) {\n      if (!content) return;\n      let meta = document.querySelector(`meta[name=\"${name}\"]`) || document.querySelector(`meta[property=\"${name}\"]`);\n      if (!meta) {\n        meta = document.createElement('meta');\n        if (name.startsWith('og:')) {\n          meta.setAttribute('property', name);\n        } else {\n          meta.setAttribute('name', name);\n        }\n        document.head.appendChild(meta);\n      }\n      meta.setAttribute('content', content);\n    },\n    toggleSearch() {\n      this.isSearchActive = !this.isSearchActive;\n    },\n    navigateToMovie(movieId) {\n      // Use full page refresh to ensure all components reinitialize\n      window.location.href = `/movie/${movieId}`;\n    },\n    navigateToCategory() {\n      // Navigate to category page with category ID\n      console.log('Navigating to category. Movie data:', this.movie);\n      console.log('Category ID:', this.movie.category_id);\n      console.log('Category:', this.movie.category);\n      const categoryId = this.movie.category_id || this.movie.category;\n      if (categoryId) {\n        console.log('Navigating to category ID:', categoryId);\n        // Use Vue Router for better debugging\n        this.$router.push({\n          name: 'CategoryVideos',\n          params: {\n            id: categoryId\n          }\n        });\n      } else {\n        console.error('No category ID found in movie data');\n        // Show error message to user\n        this.$store.dispatch('showToast', {\n          message: 'Category information not available',\n          type: 'error'\n        });\n      }\n    },\n    goBack() {\n      this.$router.go(-1);\n    },\n    capitalizeText(text) {\n      if (!text) return '';\n      // Split by spaces and special characters\n      return text.split(/[\\s-]+/).map(word => {\n        // Don't change case for special words\n        const specialWords = ['HD', 'UHD', '4K', 'TV', 'II', 'III', 'IV', 'SPY'];\n        if (specialWords.includes(word.toUpperCase())) {\n          return word.toUpperCase();\n        }\n        // Don't change case for articles and conjunctions in middle of title\n        const minorWords = ['a', 'an', 'the', 'and', 'but', 'or', 'for', 'nor', 'in', 'to', 'on', 'at', 'by', 'of'];\n        if (minorWords.includes(word.toLowerCase())) {\n          return word.toLowerCase();\n        }\n        return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();\n      }).join(' ');\n    },\n    async fetchMovieDetails() {\n      try {\n        // Make API call to get movie details\n        const response = await axios.get(`${API_BASE_URL}/api/videos/${this.id}/`);\n        console.log('API Response:', response.data);\n        if (response.data) {\n          // Apply capitalization to title and description\n          this.movie = {\n            ...response.data,\n            title: this.capitalizeText(response.data.title),\n            description: this.capitalizeText(response.data.description)\n          };\n\n          // Update meta tags for social sharing\n          this.updateMetaTags();\n\n          // Set video URL based on available formats\n          if (response.data.hls_url) {\n            this.videoUrl = response.data.hls_url;\n            this.streamType = 'hls';\n          } else {\n            throw new Error('No video URL available');\n          }\n          console.log('Set video URL:', this.videoUrl);\n          console.log('Stream type:', this.streamType);\n\n          // Fetch related videos from same category\n          await this.fetchCategoryVideos();\n\n          // Fetch recently added videos\n          await this.fetchRecentlyAddedVideos();\n        } else {\n          throw new Error('Invalid response data');\n        }\n      } catch (error) {\n        console.error('Error fetching movie details:', error);\n        this.$store.dispatch('showToast', {\n          message: 'Error loading movie details. Please try again later.',\n          type: 'error'\n        });\n      }\n    },\n    async fetchCategoryVideos() {\n      try {\n        console.log('Fetching category videos for movie:', this.movie);\n        console.log('Category ID:', this.movie.category_id);\n        console.log('Category Name:', this.movie.category_name);\n        if (!this.movie.category_id && !this.movie.category_name) {\n          console.log('No category information available');\n          // Use fallback data\n          this.categoryVideos = this.relatedMovies.slice(0, 8);\n          return;\n        }\n\n        // Use the correct API endpoint for category videos\n        const categoryId = this.movie.category_id || this.movie.category;\n        if (!categoryId) {\n          console.log('No category ID found');\n          this.categoryVideos = this.relatedMovies.slice(0, 8);\n          return;\n        }\n        const response = await axios.get(`${API_BASE_URL}/api/videos/category/${categoryId}/?page=1&page_size=12`);\n        if (response.data && response.data.status === 'success') {\n          console.log('Category videos API response:', response.data);\n\n          // Filter out current video from the results\n          let videos = response.data.data || [];\n          videos = videos.filter(video => video.id !== this.movie.id);\n          this.categoryVideos = videos.slice(0, 12).map(video => ({\n            ...video,\n            title: this.capitalizeText(video.title)\n          }));\n          console.log('Processed category videos:', this.categoryVideos);\n        } else {\n          console.log('No API response or invalid status, using fallback data');\n          // Use fallback data\n          this.categoryVideos = this.relatedMovies.slice(0, 8);\n        }\n\n        // Update scroll buttons after data loads\n        this.$nextTick(() => {\n          this.checkScrollButtons('categoryContainer', 'category');\n        });\n      } catch (error) {\n        console.error('Error fetching category videos:', error);\n        console.log('Using fallback data due to error');\n        // Use fallback data on error\n        this.categoryVideos = this.relatedMovies.slice(0, 8);\n      }\n    },\n    async fetchRecentlyAddedVideos() {\n      try {\n        console.log('Fetching recently added videos');\n        const response = await axios.get(`${API_BASE_URL}/api/videos/`, {\n          params: {\n            ordering: '-created_at',\n            limit: 20\n          }\n        });\n        let videos = [];\n        if (response.data) {\n          if (Array.isArray(response.data)) {\n            videos = response.data;\n          } else if (response.data.results) {\n            videos = response.data.results;\n          } else if (response.data.data) {\n            videos = response.data.data;\n          }\n        }\n\n        // Filter out current video from the results\n        videos = videos.filter(video => video.id !== this.movie.id);\n        this.recentlyAddedVideos = videos.slice(0, 12).map(video => ({\n          ...video,\n          title: this.capitalizeText(video.title)\n        }));\n        console.log('Processed recently added videos:', this.recentlyAddedVideos);\n\n        // Update scroll buttons after data loads\n        this.$nextTick(() => {\n          this.checkScrollButtons('recentlyAddedContainer', 'recentlyAdded');\n        });\n      } catch (error) {\n        console.error('Error fetching recently added videos:', error);\n        // Use fallback data on error\n        this.recentlyAddedVideos = this.relatedMovies.slice(0, 8);\n      }\n    },\n    checkDeviceType() {\n      // Check if mobile based on screen width or user agent\n      this.isMobileDevice = window.innerWidth < 768 || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n\n      // Adjust video control timeout based on device type\n      this.videoInteractionDelay = this.isMobileDevice ? 3500 : 2500; // Mobile needs longer timeout\n    },\n    showControlsOnInteraction() {\n      // Make controls visible on interaction\n      this.controlsVisible = true;\n\n      // Reset the timeout when there's interaction\n      this.resetControlsTimer();\n    },\n    resetControlsTimer() {\n      // Clear any existing timeout\n      if (this.controlsTimeout) {\n        clearTimeout(this.controlsTimeout);\n      }\n\n      // If video is playing (not paused), set a timeout to hide controls\n      if (!this.isVideoPaused) {\n        this.controlsTimeout = setTimeout(() => {\n          this.controlsVisible = false;\n        }, this.videoInteractionDelay);\n      }\n    },\n    toggleControlsVisibility(event) {\n      // Prevent default behavior\n      event.preventDefault();\n\n      // Toggle controls visibility on tap/click (common OTT pattern)\n      this.controlsVisible = !this.controlsVisible;\n      if (this.controlsVisible && !this.isVideoPaused) {\n        // If showing controls and video is playing, reset the timer\n        this.resetControlsTimer();\n      }\n    },\n    onVideoPlay() {\n      this.isVideoPaused = false;\n      this.resetControlsTimer(); // Start the timer to hide controls\n    },\n    onVideoPause() {\n      this.isVideoPaused = true;\n      this.controlsVisible = true; // Always show controls when paused\n\n      // Clear any existing timeout\n      if (this.controlsTimeout) {\n        clearTimeout(this.controlsTimeout);\n      }\n    },\n    handleVideoError(errorMessage) {\n      console.error('Video playback error:', errorMessage);\n\n      // If DASH format fails, try falling back to MP4\n      if (this.streamType === 'dash' && this.videoUrl.includes('.mpd')) {\n        this.streamType = 'mp4';\n        this.videoUrl = 'https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8';\n        console.log('Falling back to MP4 format');\n\n        // Retry with MP4\n        if (this.$refs.videoPlayer) {\n          this.$refs.videoPlayer.retry();\n        }\n      }\n    },\n    checkScrollButtons(containerId, section) {\n      const container = this.$refs[containerId];\n      if (!container) return;\n\n      // Check if we can scroll left\n      this.canScrollLeft[section] = container.scrollLeft > 0;\n\n      // Check if we can scroll right\n      const maxScroll = container.scrollWidth - container.clientWidth;\n      this.canScrollRight[section] = container.scrollLeft < maxScroll - 1; // -1 for rounding errors\n    },\n    scrollLeft(containerId) {\n      const container = this.$refs[containerId];\n      if (!container) return;\n      const cardWidth = containerId === 'categoryContainer' || containerId === 'recentlyAddedContainer' ? 160 : 180; // Adjust based on card width\n      const visibleWidth = container.clientWidth;\n      const cardsToScroll = Math.floor(visibleWidth / cardWidth);\n      const scrollAmount = cardWidth * cardsToScroll;\n      const targetScroll = Math.max(0, container.scrollLeft - scrollAmount);\n      container.scrollTo({\n        left: targetScroll,\n        behavior: 'smooth'\n      });\n    },\n    scrollRight(containerId) {\n      const container = this.$refs[containerId];\n      if (!container) return;\n      const cardWidth = containerId === 'categoryContainer' || containerId === 'recentlyAddedContainer' ? 160 : 180; // Adjust based on card width\n      const visibleWidth = container.clientWidth;\n      const cardsToScroll = Math.floor(visibleWidth / cardWidth);\n      const scrollAmount = cardWidth * cardsToScroll;\n      const maxScroll = container.scrollWidth - container.clientWidth;\n      const targetScroll = Math.min(maxScroll, container.scrollLeft + scrollAmount);\n      container.scrollTo({\n        left: targetScroll,\n        behavior: 'smooth'\n      });\n    },\n    handleScroll() {\n      const header = document.querySelector('.header-with-gradient');\n      if (header) {\n        if (window.scrollY > 50) {\n          header.classList.add('scrolled');\n        } else {\n          header.classList.remove('scrolled');\n        }\n      }\n    },\n    // Handle subscription payment\n    handleSubscribe() {\n      // Close the payment popup\n      this.showPaymentPopup = false;\n      // Redirect to subscription plans page\n      this.$router.push({\n        name: 'SubscriptionPlans',\n        query: {\n          redirect: this.$route.fullPath,\n          // Store current movie page URL\n          video_id: this.movie.id // Pass video ID\n        }\n      });\n    },\n    // Close payment popup\n    closePaymentPopup() {\n      this.showPaymentPopup = false;\n    },\n    handlePromoVideoEnd() {\n      console.log('Promo video ended');\n      const video = this.$refs.heroVideo;\n      if (video) {\n        // Reset to beginning and play again\n        video.currentTime = 0;\n        video.play().catch(error => {\n          console.log('Error replaying promo video:', error);\n        });\n      }\n      this.isPromoPlaying = false;\n    },\n    // Helper to initialize or update video.js player for promo/main video\n    initVideoJsPlayer(videoEl, videoSrc) {\n      if (!videoEl) return;\n      // Only initialize if not already initialized\n      if (!videoEl._videojsPlayer) {\n        videoEl._videojsPlayer = videojs(videoEl, {\n          controls: true,\n          autoplay: true,\n          muted: true,\n          preload: 'auto',\n          fluid: true\n        });\n        videoEl._videojsPlayer.on('error', () => {\n          this.promoVideoError = videoEl._videojsPlayer.error();\n          console.error('Video.js error:', this.promoVideoError);\n        });\n      }\n      // Only update source if changed\n      if (videoEl._videojsPlayer.currentSrc() !== videoSrc) {\n        videoEl._videojsPlayer.src({\n          src: videoSrc,\n          type: 'application/x-mpegURL'\n        });\n      }\n      // Reset playing state before playback\n      this.isPromoPlaying = false;\n      videoEl._videojsPlayer.off('playing'); // Remove previous listeners\n      videoEl._videojsPlayer.on('playing', () => {\n        this.isPromoPlaying = true;\n        this.$forceUpdate(); // Ensure Vue reactivity\n        console.log('video.js playing event fired, isPromoPlaying set to true');\n      });\n      videoEl._videojsPlayer.ready(() => {\n        videoEl._videojsPlayer.muted(true);\n        videoEl._videojsPlayer.play().then(() => {\n          console.log('Video should be playing');\n          console.log('Player state:', videoEl._videojsPlayer.paused(), videoEl._videojsPlayer.currentSrc());\n        }).catch(e => {\n          console.error('Auto-play prevented:', e);\n        });\n      });\n      // Add native error event logging\n      videoEl.addEventListener('error', e => {\n        console.error('Native video error:', e);\n      });\n    },\n    async playPromo() {\n      try {\n        if (!this.movie.promo_hls_url) {\n          throw new Error('No promo video URL available');\n        }\n        this.controlsVisible = true;\n        this.isVideoPaused = false;\n        this.isVideoPlaying = true;\n        this.isPlayingPromo = true;\n        this.videoUrl = this.movie.promo_hls_url;\n        this.streamType = 'hls';\n        document.body.style.overflow = 'hidden';\n        this.$nextTick(() => {\n          const video = this.$refs.heroVideo;\n          if (video) {\n            video.muted = true;\n            this.initVideoJsPlayer(video, this.movie.promo_hls_url);\n          } else {\n            throw new Error('Video player initialization failed');\n          }\n        });\n      } catch (error) {\n        console.error('Error playing promo video:', error);\n        this.promoHasError = true; // Hide promo button on error\n        this.$store.dispatch('showToast', {\n          message: 'Sorry, the promo video is not available at the moment. Please try again later.',\n          type: 'error'\n        });\n        this.isVideoPlaying = false;\n        this.isPlayingPromo = false;\n        document.body.style.overflow = 'auto';\n      }\n    },\n    shareToWhatsApp() {\n      const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n      const text = `Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`;\n\n      // For WhatsApp, we need to use a different approach for image sharing\n      if (imageUrl && this.isMobileDevice) {\n        // Try to use native sharing with image for mobile devices\n        const shareData = {\n          title: this.movie.title,\n          text: text,\n          url: this.shareUrl,\n          files: [imageUrl]\n        };\n        if (navigator.canShare && navigator.canShare(shareData)) {\n          navigator.share(shareData).then(() => {\n            this.$store.dispatch('showToast', {\n              message: 'Shared to WhatsApp with image!',\n              type: 'success'\n            });\n          }).catch(error => {\n            console.error('WhatsApp share error:', error);\n            // Fallback to text-only WhatsApp sharing\n            this.shareToWhatsAppTextOnly(text);\n          });\n        } else {\n          // Fallback to text-only WhatsApp sharing\n          this.shareToWhatsAppTextOnly(text);\n        }\n      } else {\n        // Desktop or no image available - use text-only sharing\n        this.shareToWhatsAppTextOnly(text);\n      }\n      this.showShareDialog = false;\n    },\n    shareToWhatsAppTextOnly(text) {\n      // Use the share URL directly to trigger rich preview\n      const shareText = `${text}\\n\\n${this.shareUrl}`;\n      const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(shareText)}`;\n      if (typeof window !== 'undefined') {\n        window.open(whatsappUrl, '_blank');\n      }\n    },\n    // Alternative method for WhatsApp image sharing using canvas\n    async shareToWhatsAppWithImage() {\n      try {\n        const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n        if (!imageUrl) {\n          this.shareToWhatsAppTextOnly(`Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`);\n          return;\n        }\n\n        // Create a canvas with the image and text overlay\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n\n        // Set canvas size\n        canvas.width = 600;\n        canvas.height = 400;\n\n        // Load the image\n        const img = new Image();\n        img.crossOrigin = 'anonymous';\n        img.onload = () => {\n          // Draw the image\n          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n          // Add a semi-transparent overlay for text readability\n          ctx.fillStyle = 'rgba(0, 0, 0, 0.6)';\n          ctx.fillRect(0, canvas.height - 120, canvas.width, 120);\n\n          // Add text\n          ctx.fillStyle = 'white';\n          ctx.font = 'bold 24px Arial';\n          ctx.textAlign = 'center';\n          ctx.fillText(this.movie.title, canvas.width / 2, canvas.height - 80);\n          ctx.font = '16px Arial';\n          ctx.fillText('Watch on No1 OTT', canvas.width / 2, canvas.height - 50);\n\n          // Convert canvas to blob\n          canvas.toBlob(blob => {\n            if (blob) {\n              // Create a file from the blob\n              const file = new File([blob], 'movie-share.jpg', {\n                type: 'image/jpeg'\n              });\n\n              // Try to share with the generated image\n              const shareData = {\n                title: this.movie.title,\n                text: `Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.shareUrl}`,\n                files: [file]\n              };\n              if (navigator.canShare && navigator.canShare(shareData)) {\n                navigator.share(shareData).then(() => {\n                  this.$store.dispatch('showToast', {\n                    message: 'Shared to WhatsApp with image!',\n                    type: 'success'\n                  });\n                }).catch(error => {\n                  console.error('WhatsApp share error:', error);\n                  this.shareToWhatsAppTextOnly(`Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`);\n                });\n              } else {\n                this.shareToWhatsAppTextOnly(`Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`);\n              }\n            }\n          }, 'image/jpeg', 0.8);\n        };\n        img.onerror = () => {\n          // If image fails to load, fallback to text-only\n          this.shareToWhatsAppTextOnly(`Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`);\n        };\n        img.src = imageUrl;\n      } catch (error) {\n        console.error('Error creating WhatsApp image share:', error);\n        this.shareToWhatsAppTextOnly(`Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`);\n      }\n    },\n    shareToFacebook() {\n      const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n      let facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(this.shareUrl)}`;\n\n      // Add image URL to Facebook share if available\n      if (imageUrl) {\n        facebookUrl += `&picture=${encodeURIComponent(imageUrl)}`;\n      }\n      if (typeof window !== 'undefined') {\n        window.open(facebookUrl, '_blank');\n      }\n      this.showShareDialog = false;\n    },\n    shareToTwitter() {\n      const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n      const text = `Check out \"${this.movie.title}\" on No1 OTT!`;\n      let twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(this.shareUrl)}`;\n\n      // Add image URL to Twitter share if available\n      if (imageUrl) {\n        twitterUrl += `&image=${encodeURIComponent(imageUrl)}`;\n      }\n      if (typeof window !== 'undefined') {\n        window.open(twitterUrl, '_blank');\n      }\n      this.showShareDialog = false;\n    },\n    async copyShareLink() {\n      if (typeof navigator === 'undefined') return;\n      try {\n        await navigator.clipboard.writeText(this.shareUrl);\n        this.copyStatus = 'Copied!';\n\n        // Show success toast\n        this.$store.dispatch('showToast', {\n          message: 'Link copied to clipboard!',\n          type: 'success'\n        });\n\n        // Reset copy status after 2 seconds\n        setTimeout(() => {\n          this.copyStatus = 'Copy';\n        }, 2000);\n      } catch (err) {\n        console.error('Failed to copy:', err);\n\n        // Fallback for older browsers\n        if (this.$refs.shareLink) {\n          this.$refs.shareLink.select();\n          document.execCommand('copy');\n          this.copyStatus = 'Copied!';\n          setTimeout(() => {\n            this.copyStatus = 'Copy';\n          }, 2000);\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["AppHeader","AppFooter","AdvancedVideoPlayer","axios","watchlistAPI","videojs","store","API_BASE_URL","axiosInstance","create","baseURL","headers","interceptors","request","use","config","token","getters","Authorization","error","Promise","reject","name","components","props","id","type","Number","String","required","data","movie","inWatchlist","isSearchActive","isVideoPlaying","controlsVisible","isVideoPaused","controlsTimeout","isMobileDevice","videoInteractionDelay","videoUrl","streamType","isUserSubscribed","promoStartDelay","drmConfig","servers","clearKeys","playerSettings","defaultQuality","preferredQualityIndex","skipInterval","keyboardShortcutsEnabled","rememberLastPosition","autoQualitySwitch","canScrollLeft","category","related","recentlyAdded","canScrollRight","categoryVideos","recentlyAddedVideos","relatedMovies","title","thumbnail_url","portrait_thumbnail_url","video_type","heroVideo","hls","showPaymentPopup","userSubscriptionStatus","showRentalPopup","rentalInfo","isSubscribed","isPromoLoading","promoVideoError","isPlayingPromo","isInWatchlist","showShareDialog","copyStatus","promoHasError","videojsPlayer","isPromoPlaying","computed","currentUserId","user","localStorage","getItem","userData","JSON","parse","e","computedStreamType","includes","movieYear","created_at","Date","getFullYear","formattedDuration","duration","totalSeconds","parseInt","isNaN","hours","Math","floor","minutes","categoryName","category_name","formattedCategories","categories","map","cat","join","shareUrl","window","location","href","shouldShowPromoButton","promo_hls_url","trim","watch","$route","scrollTo","fetchMovieDetails","then","$nextTick","initializeHeroVideo","immediate","handler","newUrl","newMovie","promo_video_url","updateMetaTags","val","console","log","mounted","checkScrollButtons","checkDeviceType","addEventListener","handleScroll","beforeUnmount","destroy","removeEventListener","clearTimeout","dispose","created","params","videoType","checkUserSubscription","loadPlayerPreferences","checkWatchlistStatus","methods","formatWatchPeriod","days","savedPreferences","preferences","Object","keys","forEach","key","undefined","savePlayerPreferences","setItem","stringify","video","$refs","videoSrc","video_url","muted","sources","src","controls","autoplay","preload","fluid","ready","play","catch","on","onPromoVideoCanPlay","onPromoVideoLoaded","classList","add","onPromoVideoWaiting","onPromoVideoPlaying","handlePromoVideoError","remove","phone","response","get","status","is_subscribed","subscription_end_date","endDate","now","isActive","checkRentalStatus","rental","goToRentalPayment","$router","push","playMovie","hls_url","Error","document","body","style","overflow","videoPlayer","resetControlsTimer","is_active","query","redirect","fullPath","video_id","$store","dispatch","message","closeVideo","toggleWatchlist","isAuthenticated","currentPath","path","commit","toggle","in_watchlist","getStatus","shareMovie","imageUrl","poster_url","shareData","text","description","url","files","navigator","share","canShare","shareWithoutImage","updateMetaTag","content","meta","querySelector","createElement","startsWith","setAttribute","head","appendChild","toggleSearch","navigateToMovie","movieId","navigateToCategory","category_id","categoryId","goBack","go","capitalizeText","split","word","specialWords","toUpperCase","minorWords","toLowerCase","charAt","slice","fetchCategoryVideos","fetchRecentlyAddedVideos","videos","filter","ordering","limit","Array","isArray","results","innerWidth","test","userAgent","showControlsOnInteraction","setTimeout","toggleControlsVisibility","event","preventDefault","onVideoPlay","onVideoPause","handleVideoError","errorMessage","retry","containerId","section","container","scrollLeft","maxScroll","scrollWidth","clientWidth","cardWidth","visibleWidth","cardsToScroll","scrollAmount","targetScroll","max","left","behavior","scrollRight","min","header","scrollY","handleSubscribe","closePaymentPopup","handlePromoVideoEnd","currentTime","initVideoJsPlayer","videoEl","_videojsPlayer","currentSrc","off","$forceUpdate","paused","playPromo","shareToWhatsApp","shareToWhatsAppTextOnly","shareText","whatsappUrl","encodeURIComponent","open","shareToWhatsAppWithImage","canvas","ctx","getContext","width","height","img","Image","crossOrigin","onload","drawImage","fillStyle","fillRect","font","textAlign","fillText","toBlob","blob","file","File","onerror","shareToFacebook","facebookUrl","shareToTwitter","twitterUrl","copyShareLink","clipboard","writeText","err","shareLink","select","execCommand"],"sources":["D:\\OTT\\ott_frontend\\src\\views\\MovieDetails.vue"],"sourcesContent":["<template>\n  <div class=\"movie-details-wrapper bg-[#121212] text-white min-h-screen\">\n    <!-- Advanced Video Player modal - Full screen when active -->\n    <div v-if=\"isVideoPlaying\" class=\"advanced-video-player-modal\" @mousemove=\"showControlsOnInteraction\" @touchstart=\"showControlsOnInteraction\" @click=\"toggleControlsVisibility\">\n      <AdvancedVideoPlayer \n        ref=\"videoPlayer\"\n        :src=\"videoUrl\"\n        :title=\"movie.title\"\n        :video-id=\"movie.id\"\n        :user-id=\"currentUserId\"\n        :streamType=\"streamType\"\n        :autoplay=\"true\"\n        :isLive=\"false\"\n        :drmConfig=\"drmConfig\"\n        :controlsVisible=\"controlsVisible\"\n        @close=\"closeVideo\"\n        @play=\"onVideoPlay\"\n        @pause=\"onVideoPause\"\n        @interaction=\"showControlsOnInteraction\"\n        @error=\"handleVideoError\"\n      />\n    </div>\n\n    <!-- Desktop header with gradient overlay -->\n    <div class=\"hide-on-mobile header-with-gradient\">\n      <AppHeader @toggle-search=\"toggleSearch\" :hideBackButton=\"true\" />\n    </div>\n    \n    <div class=\"movie-detail-container\">\n      <!-- Hero Banner Section with Backdrop Image -->\n      <div class=\"movie-backdrop\">\n        <!-- Thumbnail background -->\n        <img \n          :src=\"isMobileDevice && movie.portrait_thumbnail_url ? movie.portrait_thumbnail_url : movie.thumbnail_url\" \n          alt=\"Movie Thumbnail\"\n          :class=\"['backdrop-image', {'portrait-mobile': isMobileDevice && movie.portrait_thumbnail_url}]\"\n          v-show=\"!isPromoPlaying && !isPromoLoading\"\n        />\n        <!-- Video overlay -->\n        <div v-if=\"movie.promo_hls_url\" class=\"video-container\">\n          <!-- Loading spinner -->\n          <div v-if=\"isPromoLoading\" class=\"video-loading\"></div>\n          <video \n            ref=\"heroVideo\"\n            class=\"backdrop-video\"\n            :poster=\"movie.thumbnail_url\"\n            autoplay\n            muted\n            loop\n            playsinline\n            preload=\"auto\"\n            @loadeddata=\"onPromoVideoLoaded\"\n            @ended=\"handlePromoVideoEnd\"\n            @error=\"handlePromoVideoError\"\n            @waiting=\"onPromoVideoWaiting\"\n            @playing=\"onPromoVideoPlaying\"\n            @canplay=\"onPromoVideoCanPlay\"\n            v-show=\"isPromoPlaying && !isPromoLoading\"\n            style=\"width: 100vw; max-width: 100vw; aspect-ratio: 16/9; object-fit: contain; background: #000; display: block; margin: 0 auto; max-height: 70vh;\"\n          >\n            <source :src=\"movie.promo_hls_url\" type=\"application/x-mpegURL\" />\n          </video>\n        </div>\n        <div class=\"backdrop-gradient\"></div>\n      </div>\n\n      <!-- Mobile-only back button -->\n      <button \n        class=\"back-btn mobile-only-element\"\n        @click=\"goBack\"\n      >\n        <i class=\"fas fa-arrow-left\"></i>\n      </button>\n\n      <!-- Movie Info Section -->\n      <div class=\"movie-info-container\">\n        <!-- Movie Badges -->\n        <div class=\"movie-badges\">\n          <span v-if=\"movie.video_type === 'paid'\" class=\"badge premium\">\n            <i class=\"fas fa-crown mr-1\"></i>\n            Premium\n          </span>\n          <span v-if=\"movie.is4K\" class=\"badge quality\">4K</span>\n        </div>\n\n        <!-- Movie Title -->\n        <h1 class=\"movie-title\">{{ movie.title }}</h1>\n        \n        <!-- Movie Meta Info -->\n        <div class=\"movie-meta\">\n          <span>{{ movieYear }}</span>\n          <span class=\"dot-divider\"></span>\n          <span>{{ formattedDuration }}</span>\n          <span class=\"dot-divider\"></span>\n          <span>{{ categoryName }}</span>\n          <!-- Rental price display for rental videos (only for free users) -->\n          <template v-if=\"movie.video_type === 'rental' && movie.prices && movie.prices.length && !isUserSubscribed\">\n            <span class=\"dot-divider\"></span>\n            <span class=\"badge premium\">\n              <i class=\"fas fa-ticket-alt mr-1\"></i>\n              Rental:\n              <template v-for=\"(price, idx) in movie.prices\" :key=\"price.id\">\n                {{ price.rental_price }} for {{ formatWatchPeriod(price.rental_duration) }}<span v-if=\"idx < movie.prices.length - 1\">, </span>\n              </template>\n            </span>\n          </template>\n          <span v-if=\"movie.video_type === 'paid' && movie.rental_price\" class=\"premium-price ml-2\">\n            {{ movie.rental_price }}\n          </span>\n        </div>\n        \n        <!-- Movie Tags -->\n        <div v-if=\"movie.mood1 || movie.mood2\" class=\"movie-tags\">\n          <span v-if=\"movie.mood1\" class=\"tag\">{{ movie.mood1 }}</span>\n          <span v-if=\"movie.mood2\" class=\"tag\">{{ movie.mood2 }}</span>\n        </div>\n        \n        <!-- Movie Description -->\n        <p class=\"movie-description\">\n          {{ movie.description }}\n        </p>\n        \n        <!-- Action Buttons - Unified design for both desktop and mobile -->\n        <div class=\"action-buttons\">\n          <button v-if=\"shouldShowPromoButton\" class=\"play-button\" @click=\"playPromo\">\n            <i class=\"fas fa-film\"></i>\n            <span>Promo</span>\n          </button>\n\n          <button class=\"play-button\" @click=\"playMovie\">\n            <i class=\"fas fa-play\"></i>\n            <span>Full Video</span>\n          </button>\n          \n          <button \n            class=\"secondary-button\" \n            @click=\"toggleWatchlist\"\n            :class=\"{ 'in-watchlist': isInWatchlist }\"\n          >\n            <i :class=\"['fas', isInWatchlist ? 'fa-bookmark' : 'fa-bookmark-o']\"></i>\n            {{ isInWatchlist ? 'Remove from Watchlist' : 'Add to Watchlist' }}\n          </button>\n          <button class=\"action-button\" @click=\"shareMovie\">\n            <i class=\"fas fa-share-alt\"></i>\n            <span class=\"action-label\">Share</span>\n          </button>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Main content sections with carousel style like Home page -->\n    <main class=\"pl-4 sm:pl-6 md:pl-10 py-4 space-y-8 relative overflow-hidden\">\n      <!-- Related Videos by Category Section -->\n      <section>\n        <div class=\"flex justify-between items-center mb-3 pr-4\">\n          <h2 class=\"gradient-text font-semibold text-base md:text-lg\">\n            {{ categoryName }} \n          </h2>\n          <a \n            class=\"text-white font-semibold text-sm hover:underline whitespace-nowrap cursor-pointer\" \n            @click=\"navigateToCategory\"\n          >\n            View All\n          </a>\n        </div>\n        <div class=\"relative carousel-container\">\n          <button\n            v-if=\"canScrollLeft.category\"\n            aria-label=\"Previous Category Videos\"\n            class=\"scroll-button left-scroll-button\"\n            @click=\"scrollLeft('categoryContainer')\"\n          >\n            <i class=\"fas fa-chevron-left\"></i>\n          </button>\n          <div\n            class=\"flex gap-4 overflow-x-auto scrollbar-hide scroll-container snap-x snap-mandatory\"\n            ref=\"categoryContainer\"\n            @scroll=\"checkScrollButtons('categoryContainer', 'category')\"\n          >\n            <div class=\"flex gap-4 pr-4 carousel-inner-container\">\n              <div \n                v-for=\"(video, index) in categoryVideos\" \n                :key=\"index\" \n                class=\"related-movie-card snap-start\"\n                @click=\"navigateToMovie(video.id)\"\n              >\n                <div class=\"relative rounded-md overflow-hidden card-container\">\n                  <img :src=\"video.portrait_thumbnail_url || video.thumbnail_url || video.poster_url\" :alt=\"video.title\" class=\"related-movie-image\">\n                  <!-- Premium badge for paid videos -->\n                  <div v-if=\"video.video_type === 'paid'\" class=\"absolute top-2 right-2\">\n                    <span class=\"bg-gradient-to-r from-[#c30059] to-[#ff0062] text-white text-xs px-2 py-1 rounded-full font-semibold\">\n                      <i class=\"fas fa-crown mr-1\"></i>Premium\n                    </span>\n                </div>\n                  <!-- 4K badge -->\n                  <div v-if=\"video.is4K\" class=\"absolute top-2 left-2\">\n                    <span class=\"bg-blue-600 text-white text-xs px-2 py-1 rounded-full font-semibold\">\n                      4K\n                    </span>\n                </div>\n                </div>\n                <p class=\"related-movie-title mt-1 text-xs font-semibold truncate card-text\">\n                  {{ capitalizeText(video.title) }}\n                </p>\n              </div>\n            </div>\n          </div>\n          <button\n            v-if=\"canScrollRight.category\"\n            aria-label=\"Next Category Videos\"\n            class=\"scroll-button right-scroll-button\"\n            @click=\"scrollRight('categoryContainer')\"\n          >\n            <i class=\"fas fa-chevron-right\"></i>\n          </button>\n        </div>\n      </section>\n      \n\n      <!-- Recently Added Section -->\n      <section>\n        <div class=\"flex justify-between items-center mb-3 pr-4\">\n          <h2 class=\"gradient-text font-semibold text-base md:text-lg\">\n            Recently Added\n          </h2>\n        </div>\n        <div class=\"relative carousel-container\">\n          <button\n            v-if=\"canScrollLeft.recentlyAdded\"\n            aria-label=\"Previous Recently Added\"\n            class=\"scroll-button left-scroll-button\"\n            @click=\"scrollLeft('recentlyAddedContainer')\"\n          >\n            <i class=\"fas fa-chevron-left\"></i>\n          </button>\n          <div\n            class=\"flex gap-4 overflow-x-auto scrollbar-hide scroll-container snap-x snap-mandatory\"\n            ref=\"recentlyAddedContainer\"\n            @scroll=\"checkScrollButtons('recentlyAddedContainer', 'recentlyAdded')\"\n          >\n            <div class=\"flex gap-4 pr-4 carousel-inner-container\">\n              <div \n                v-for=\"(video, index) in recentlyAddedVideos\" \n                :key=\"index\" \n                class=\"related-movie-card snap-start\"\n                @click=\"navigateToMovie(video.id)\"\n              >\n                <div class=\"relative rounded-md overflow-hidden card-container\">\n                  <img :src=\"video.portrait_thumbnail_url || video.thumbnail_url || video.poster_url\" :alt=\"video.title\" class=\"related-movie-image\">\n                  <!-- Premium badge for paid videos -->\n                  <div v-if=\"video.video_type === 'paid'\" class=\"absolute top-2 right-2 flex items-center justify-center w-8 h-8 rounded-full bg-gradient-to-r from-[#c30059] to-[#ff0062] shadow\">\n                    <i class=\"fas fa-crown text-white text-base\"></i>\n                  </div>\n                  <!-- 4K badge -->\n                  <div v-if=\"video.is4K\" class=\"absolute bottom-2 left-2\">\n                    <span class=\"bg-blue-600 text-white text-xs px-2 py-1 rounded-full font-semibold\">\n                      4K\n                    </span>\n                  </div>\n                </div>\n                <p class=\"related-movie-title mt-1 text-xs font-semibold truncate card-text\">\n                  {{ capitalizeText(video.title) }}\n                </p>\n              </div>\n            </div>\n          </div>\n          <button\n            v-if=\"canScrollRight.recentlyAdded\"\n            aria-label=\"Next Recently Added\"\n            class=\"scroll-button right-scroll-button\"\n            @click=\"scrollRight('recentlyAddedContainer')\"\n          >\n            <i class=\"fas fa-chevron-right\"></i>\n          </button>\n        </div>\n      </section>\n    </main>\n\n    <!-- Mobile Search Bar -->\n    <div class=\"mobile-search-bar\" :class=\"{ active: isSearchActive }\">\n      <input type=\"text\" placeholder=\"Search movies, shows and more...\">\n      <button class=\"text-white\" @click=\"toggleSearch\">\n        <i class=\"fas fa-times\"></i>\n      </button>\n    </div>\n\n    <!-- Payment Popup -->\n    <div v-if=\"showPaymentPopup\" class=\"payment-popup-overlay\">\n      <div class=\"payment-popup\">\n        <div class=\"popup-header\">\n          <div class=\"flex items-center gap-3\">\n            <div class=\"premium-badge\">\n              <i class=\"fas fa-crown\"></i>\n            </div>\n            <div>\n              <h2 class=\"text-xl font-bold\">Premium Content</h2>\n              <p class=\"text-sm text-white/60\">Subscribe to Continue Watching</p>\n            </div>\n          </div>\n          <button @click=\"closePaymentPopup\" class=\"close-button\">\n            <i class=\"fas fa-times\"></i>\n          </button>\n        </div>\n        \n        <div class=\"popup-content\">\n          <!-- Movie Preview -->\n          <div class=\"movie-preview\">\n            <img :src=\"movie.thumbnail_url || movie.poster_url\" alt=\"Movie Thumbnail\" class=\"popup-thumbnail\">\n            <div class=\"movie-info\">\n              <h3 class=\"movie-title\">{{ movie.title }}</h3>\n              <div class=\"flex items-center gap-2 text-sm text-white/60\">\n                <span v-if=\"formattedDuration\">{{ formattedDuration }}</span>\n                <span v-if=\"formattedDuration && categoryName\" class=\"dot-divider\"></span>\n                <span>{{ categoryName }}</span>\n              </div>\n            </div>\n          </div>\n\n          <!-- Premium Features -->\n          <div class=\"premium-features\">\n            <h4 class=\"text-lg font-semibold mb-4\">Premium Benefits</h4>\n            <div class=\"features-grid\">\n              <div class=\"feature-item\">\n                <i class=\"fas fa-film text-[#c30059]\"></i>\n                <div>\n                  <p class=\"font-medium\">All Premium Content</p>\n                  <p class=\"text-sm text-white/60\">Unlimited access to premium movies & shows</p>\n                </div>\n              </div>\n              <div class=\"feature-item\">\n                <i class=\"fas fa-tv text-[#c30059]\"></i>\n                <div>\n                  <p class=\"font-medium\">Watch on Any Device</p>\n                  <p class=\"text-sm text-white/60\">TV, laptop, phone, or tablet</p>\n                </div>\n              </div>\n              <div class=\"feature-item\">\n                <i class=\"fas fa-ban text-[#c30059]\"></i>\n                <div>\n                  <p class=\"font-medium\">Ad-Free Experience</p>\n                  <p class=\"text-sm text-white/60\">Uninterrupted entertainment</p>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <!-- Action Button -->\n          <button @click=\"handleSubscribe\" class=\"subscribe-button\">\n            <span>View Plans & Subscribe</span>\n            <i class=\"fas fa-arrow-right\"></i>\n          </button>\n\n          <!-- Price Note -->\n          <p class=\"text-center text-sm text-white/60 mt-4\">\n            Plans start from 365/year (1/day)\n          </p>\n        </div>\n      </div>\n    </div>\n\n    <!-- Add Rental Popup -->\n    <div v-if=\"showRentalPopup\" class=\"payment-popup-overlay\">\n      <div class=\"payment-popup\">\n        <div class=\"popup-header\">\n          <div class=\"flex items-center gap-3\">\n            <div class=\"premium-badge\">\n              <i class=\"fas fa-ticket-alt\"></i>\n            </div>\n            <div>\n              <h2 class=\"text-xl font-bold\">{{ movie.title }}</h2>\n              <p class=\"text-sm text-white/60\">\n                {{ formatWatchPeriod(movie.prices[0].rental_duration) }} Rental\n              </p>\n            </div>\n          </div>\n          <button @click=\"showRentalPopup = false\" class=\"close-button\">\n            <i class=\"fas fa-times\"></i>\n          </button>\n        </div>\n        \n        <div class=\"popup-content\">\n          <!-- Movie Preview -->\n          <div class=\"movie-preview\">\n            <img :src=\"movie.thumbnail_url || movie.poster_url\" alt=\"Movie Thumbnail\" class=\"popup-thumbnail\">\n            <div class=\"movie-info\">\n              <h3 class=\"movie-title\">{{ movie.title }}</h3>\n              <div class=\"flex items-center gap-2 text-sm text-white/60\">\n                <span v-if=\"formattedDuration\">{{ formattedDuration }}</span>\n                <span v-if=\"formattedDuration && categoryName\" class=\"dot-divider\"></span>\n                <span>{{ categoryName }}</span>\n              </div>\n            </div>\n          </div>\n\n          <!-- Rental Details -->\n          <div class=\"rental-details bg-white/5 rounded-lg p-4 my-4\">\n            <div class=\"flex justify-between items-center mb-2\">\n              <span class=\"text-white/60\">Rental Price</span>\n              <span class=\"text-xl font-bold\">{{ movie.prices[0].rental_price }}</span>\n            </div>\n            <div class=\"flex justify-between items-center\">\n              <span class=\"text-white/60\">Watch Period</span>\n              <span>{{ formatWatchPeriod(movie.prices[0].rental_duration) }}</span>\n            </div>\n          </div>\n\n          <!-- Action Button -->\n          <button @click=\"goToRentalPayment\" class=\"subscribe-button\">\n            <span>Rent for {{ formatWatchPeriod(movie.prices[0].rental_duration) }} at {{ movie.prices[0].rental_price }}</span>\n            <i class=\"fas fa-arrow-right\"></i>\n          </button>\n\n          <!-- Terms -->\n          <p class=\"text-center text-sm text-white/60 mt-4\">\n            Available to watch for {{ formatWatchPeriod(movie.prices[0].rental_duration) }} after payment\n          </p>\n        </div>\n      </div>\n    </div>\n\n    <AppFooter />\n\n    <!-- Share Dialog -->\n    <div v-if=\"showShareDialog\" class=\"fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50 backdrop-blur-sm\">\n      <div class=\"bg-[#1d1d1d] rounded-xl w-full max-w-md p-6\">\n        <div class=\"flex justify-between items-center mb-6\">\n          <h3 class=\"text-xl font-bold\">Share \"{{ movie.title }}\"</h3>\n          <button @click=\"showShareDialog = false\" class=\"text-white/60 hover:text-white\">\n            <i class=\"fas fa-times\"></i>\n          </button>\n        </div>\n\n        <!-- Movie Preview with Image -->\n        <div class=\"flex items-center gap-4 mb-6 p-4 bg-[#121212] rounded-lg\">\n          <img \n            :src=\"movie.thumbnail_url || movie.portrait_thumbnail_url || movie.poster_url\" \n            :alt=\"movie.title\"\n            class=\"w-16 h-24 object-cover rounded-lg\"\n          />\n          <div class=\"flex-1\">\n            <h4 class=\"font-semibold text-white mb-1\">{{ movie.title }}</h4>\n            <p class=\"text-sm text-gray-400 line-clamp-2\">{{ movie.description }}</p>\n          </div>\n        </div>\n\n        <!-- Share Options -->\n        <div class=\"grid grid-cols-2 gap-4 mb-6\">\n          <!-- WhatsApp -->\n          <button \n            @click=\"shareToWhatsAppWithImage\"\n            class=\"flex items-center gap-3 bg-[#25D366]/10 p-4 rounded-lg hover:bg-[#25D366]/20 transition-all\"\n          >\n            <i class=\"fab fa-whatsapp text-[#25D366] text-2xl\"></i>\n            <span>WhatsApp</span>\n          </button>\n\n          <!-- Facebook -->\n          <button \n            @click=\"shareToFacebook\"\n            class=\"flex items-center gap-3 bg-[#1877F2]/10 p-4 rounded-lg hover:bg-[#1877F2]/20 transition-all\"\n          >\n            <i class=\"fab fa-facebook text-[#1877F2] text-2xl\"></i>\n            <span>Facebook</span>\n          </button>\n\n          <!-- Twitter -->\n          <button \n            @click=\"shareToTwitter\"\n            class=\"flex items-center gap-3 bg-[#1DA1F2]/10 p-4 rounded-lg hover:bg-[#1DA1F2]/20 transition-all\"\n          >\n            <i class=\"fab fa-twitter text-[#1DA1F2] text-2xl\"></i>\n            <span>Twitter</span>\n          </button>\n\n          <!-- Copy Link -->\n          <button \n            @click=\"copyShareLink\"\n            class=\"flex items-center gap-3 bg-white/10 p-4 rounded-lg hover:bg-white/20 transition-all\"\n          >\n            <i class=\"fas fa-link text-white text-2xl\"></i>\n            <span>Copy Link</span>\n          </button>\n        </div>\n\n        <!-- Share Link -->\n        <div class=\"relative\">\n          <input \n            ref=\"shareLink\"\n            type=\"text\"\n            :value=\"shareUrl\"\n            class=\"w-full bg-[#121212] border border-white/10 rounded-lg h-12 px-4 pr-24 text-white focus:border-[#c30059] focus:outline-none transition-colors\"\n            readonly\n          />\n          <button \n            @click=\"copyShareLink\"\n            class=\"absolute right-2 top-1/2 -translate-y-1/2 text-sm text-[#c30059] hover:text-[#a80048] transition-colors\"\n          >\n            {{ copyStatus }}\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport AppHeader from '../components/Header.vue'\nimport AppFooter from '../components/Footer.vue'\nimport AdvancedVideoPlayer from '../components/AdvancedVideoPlayer.vue'\nimport axios from 'axios'\nimport { watchlistAPI } from '@/utils/api'\nimport videojs from 'video.js';\nimport 'video.js/dist/video-js.css';\nimport store from '@/store';\n\n// Define API base URL constant\nconst API_BASE_URL = 'https://admin.no1ott.com'\n\n// Create axios instance with default config\nconst axiosInstance = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Add request interceptor to add token\naxiosInstance.interceptors.request.use(\n  (config) => {\n    const token = store.getters.token;\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\nexport default {\n  name: 'MovieDetails',\n  components: {\n    AppHeader,\n    AppFooter,\n    AdvancedVideoPlayer\n  },\n  props: {\n    id: {\n      type: [Number, String],\n      required: true\n    }\n  },\n  data() {\n    return {\n      movie: {},\n      inWatchlist: false,\n      isSearchActive: false,\n      isVideoPlaying: false,\n      controlsVisible: true,\n      isVideoPaused: false,\n      controlsTimeout: null,\n      isMobileDevice: false,\n      videoInteractionDelay: 2500,\n      videoUrl: '',\n      streamType: 'hls',\n      isUserSubscribed: false,\n      promoStartDelay: 3000, // 3 seconds delay before starting promo\n      drmConfig: {\n        // DRM configuration if needed\n        // Example for Widevine:\n        servers: {\n          'com.widevine.alpha': 'https://license.url/widevine'\n        },\n        // Example for Clear Key:\n        clearKeys: {\n          // keyId: 'key' pairs\n        }\n      },\n      playerSettings: {\n        defaultQuality: 'auto',\n        preferredQualityIndex: 1,\n        skipInterval: 10, // seconds\n        keyboardShortcutsEnabled: true,\n        rememberLastPosition: true,\n        autoQualitySwitch: true\n      },\n      canScrollLeft: {\n        category: false,\n        related: false,\n        recentlyAdded: false\n      },\n      canScrollRight: {\n        category: true,\n        related: true,\n        recentlyAdded: true\n      },\n      categoryVideos: [],\n      recentlyAddedVideos: [],\n      relatedMovies: [\n        {\n          id: 101,\n          title: 'Midnight Mystery',\n          thumbnail_url: 'https://i.ibb.co/cDfWsvC/related1.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/cDfWsvC/related1.jpg',\n          video_type: 'free'\n        },\n        {\n          id: 102,\n          title: 'The Stranger',\n          thumbnail_url: 'https://i.ibb.co/DkFnm7g/related2.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/DkFnm7g/related2.jpg',\n          video_type: 'paid'\n        },\n        {\n          id: 103,\n          title: 'Dark Echo',\n          thumbnail_url: 'https://i.ibb.co/MRVvFDZ/related3.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/MRVvFDZ/related3.jpg',\n          video_type: 'free'\n        },\n        {\n          id: 104,\n          title: 'Silent Night',\n          thumbnail_url: 'https://i.ibb.co/5cG2WXF/related4.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/5cG2WXF/related4.jpg',\n          video_type: 'rental'\n        },\n        {\n          id: 105,\n          title: 'The Guilty',\n          thumbnail_url: 'https://i.ibb.co/mBVR2KM/related5.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/mBVR2KM/related5.jpg',\n          video_type: 'free'\n        },\n        {\n          id: 106,\n          title: 'Trance',\n          thumbnail_url: 'https://i.ibb.co/hWD1BXg/related6.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/hWD1BXg/related6.jpg',\n          video_type: 'paid'\n        },\n        {\n          id: 107,\n          title: 'Haunted House',\n          thumbnail_url: 'https://i.ibb.co/k8DQzTF/related7.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/k8DQzTF/related7.jpg',\n          video_type: 'free'\n        },\n        {\n          id: 108,\n          title: 'Night Watch',\n          thumbnail_url: 'https://i.ibb.co/hyCJTBL/related8.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/hyCJTBL/related8.jpg',\n          video_type: 'rental'\n        },\n        {\n          id: 109,\n          title: 'The Missing',\n          thumbnail_url: 'https://i.ibb.co/dj8rS0M/related9.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/dj8rS0M/related9.jpg',\n          video_type: 'free'\n        },\n        {\n          id: 110,\n          title: 'Fear Factor',\n          thumbnail_url: 'https://i.ibb.co/8XvX1fL/related10.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/8XvX1fL/related10.jpg',\n          video_type: 'paid'\n        },\n        {\n          id: 111,\n          title: 'Paranormal',\n          thumbnail_url: 'https://i.ibb.co/r57Kzc5/related11.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/r57Kzc5/related11.jpg',\n          video_type: 'free'\n        },\n        {\n          id: 112,\n          title: 'Last Breath',\n          thumbnail_url: 'https://i.ibb.co/B6wS7HK/related12.jpg',\n          portrait_thumbnail_url: 'https://i.ibb.co/B6wS7HK/related12.jpg',\n          video_type: 'rental'\n        }\n      ],\n      heroVideo: null,\n      hls: null,\n      showPaymentPopup: false,\n      userSubscriptionStatus: null,\n      showRentalPopup: false,\n      rentalInfo: null,\n      isSubscribed: false,\n      isPromoLoading: true,\n      promoVideoError: null,\n      isPlayingPromo: false,\n      isInWatchlist: false,\n      showShareDialog: false,\n      copyStatus: 'Copy',\n      promoHasError: false,\n      videojsPlayer: null,\n      isPromoPlaying: false\n    }\n  },\n  computed: {\n    // Get current user ID from localStorage\n    currentUserId() {\n      const user = localStorage.getItem('user');\n      if (user) {\n        try {\n          const userData = JSON.parse(user);\n          return userData.id || 1; // Default to 1 if no user ID\n        } catch (e) {\n          return 1; // Default to 1 if parsing fails\n        }\n      }\n      return 1; // Default to 1 if no user data\n    },\n    // Get the appropriate stream type based on the video URL or device capabilities\n    computedStreamType() {\n      // Check if the URL ends with specific extensions\n      if (this.videoUrl.includes('.m3u8')) {\n        return 'hls';\n      } else if (this.videoUrl.includes('.mpd')) {\n        return 'dash';\n      } else if (this.videoUrl.includes('.mp4')) {\n        // Explicitly handle MP4 files\n        return 'mp4';\n      }\n      // Default fallback\n      return 'mp4';\n    },\n    // Get the year from created_at\n    movieYear() {\n      if (this.movie && this.movie.created_at) {\n        return new Date(this.movie.created_at).getFullYear();\n      }\n      return new Date().getFullYear(); // Fallback to current year\n    },\n    // Format duration from seconds to hours and minutes\n    formattedDuration() {\n      if (!this.movie || !this.movie.duration) return '';\n      \n      const totalSeconds = parseInt(this.movie.duration);\n      if (isNaN(totalSeconds)) return '';\n      \n      const hours = Math.floor(totalSeconds / 3600);\n      const minutes = Math.floor((totalSeconds % 3600) / 60);\n      \n      if (hours === 0) {\n        return `${minutes}m`;\n      } else if (minutes === 0) {\n        return `${hours}h`;\n      } else {\n        return `${hours}h ${minutes}m`;\n      }\n    },\n    // Get category name\n    categoryName() {\n      if (!this.movie) return '';\n      return this.movie.category_name || ''; // Directly use category_name from API\n    },\n    // Get formatted categories\n    formattedCategories() {\n      if (!this.movie || !this.movie.categories) return '';\n      return this.movie.categories.map(cat => cat.name).join(', ');\n    },\n    \n    shareUrl() {\n      if (typeof window !== 'undefined') {\n        return window.location.href;\n      }\n      return '';\n    },\n    \n    // Check if promo button should be shown\n    shouldShowPromoButton() {\n      return this.movie && \n             this.movie.promo_hls_url && \n             this.movie.promo_hls_url.trim() !== '' && \n             !this.promoHasError;\n    }\n  },\n  watch: {\n    // Watch for route changes to reset scroll position when navigating between movie details pages\n    '$route'() {\n      window.scrollTo(0, 0);\n      this.fetchMovieDetails().then(() => {\n        // Initialize hero video after fetching new movie details\n        this.$nextTick(() => {\n          this.initializeHeroVideo();\n        });\n      });\n    },\n    // Update stream type based on the video URL\n    videoUrl: {\n      immediate: true,\n      handler(newUrl) {\n        // Update stream type based on the new URL\n        if (newUrl) {\n          this.streamType = this.computedStreamType;\n        }\n      }\n    },\n    // Add watcher for movie data\n    movie: {\n      immediate: true,\n      handler(newMovie) {\n        if (newMovie && (newMovie.promo_hls_url || newMovie.promo_video_url)) {\n          this.$nextTick(() => {\n            this.initializeHeroVideo();\n          });\n        }\n        \n        // Update meta tags when movie data changes\n        if (newMovie) {\n          this.$nextTick(() => {\n            this.updateMetaTags();\n          });\n        }\n      }\n    },\n    // Debug watcher for isPromoPlaying\n    isPromoPlaying(val) {\n      console.log('isPromoPlaying changed:', val);\n    }\n  },\n  mounted() {\n    // Initialize hero video with HLS\n    this.initializeHeroVideo();\n    \n    this.$nextTick(() => {\n      this.checkScrollButtons('categoryContainer', 'category')\n      this.checkScrollButtons('relatedContainer', 'related')\n      this.checkScrollButtons('recentlyAddedContainer', 'recentlyAdded')\n      \n      // Check if mobile device\n      this.checkDeviceType()\n      \n      // Listen for resize events to update device type\n      window.addEventListener('resize', this.checkDeviceType)\n\n      // Add scroll event listener for header background\n      window.addEventListener('scroll', this.handleScroll)\n      \n      // Update meta tags after component is mounted\n      if (this.movie) {\n        this.updateMetaTags();\n      }\n    })\n  },\n  beforeUnmount() {\n    // Clean up HLS instance\n    if (this.hls) {\n      this.hls.destroy();\n    }\n    \n    // Clean up resize listener\n    window.removeEventListener('resize', this.checkDeviceType)\n    \n    // Clean up scroll listener\n    window.removeEventListener('scroll', this.handleScroll)\n    \n    // Clear any active control timeouts\n    if (this.controlsTimeout) {\n      clearTimeout(this.controlsTimeout)\n    }\n    if (this.videojsPlayer) {\n      this.videojsPlayer.dispose();\n      this.videojsPlayer = null;\n    }\n  },\n  created() {\n    // Get video URL from route params if available\n    if (this.$route.params.videoUrl) {\n      this.videoUrl = this.$route.params.videoUrl;\n      this.streamType = this.$route.params.videoType || 'hls';\n    }\n    \n    // Check subscription status\n    this.checkUserSubscription().then(isSubscribed => {\n      this.isUserSubscribed = isSubscribed;\n    });\n    \n    // Fetch movie details\n    this.fetchMovieDetails();\n    \n    // Load any saved player preferences from localStorage\n    this.loadPlayerPreferences();\n    this.checkWatchlistStatus();\n  },\n  methods: {\n    formatWatchPeriod(days) {\n      if (!days) return '';\n      return `${days} ${days === 1 ? 'day' : 'days'}`;\n    },\n    \n    loadPlayerPreferences() {\n      // Load user preferences from localStorage\n      const savedPreferences = localStorage.getItem('player-preferences');\n      if (savedPreferences) {\n        try {\n          const preferences = JSON.parse(savedPreferences);\n          // Apply only the properties that exist in our settings object\n          Object.keys(this.playerSettings).forEach(key => {\n            if (preferences[key] !== undefined) {\n              this.playerSettings[key] = preferences[key];\n            }\n          });\n        } catch (e) {\n          console.error('Error parsing saved player preferences', e);\n        }\n      }\n    },\n    savePlayerPreferences() {\n      // Save current player settings to localStorage\n      localStorage.setItem('player-preferences', JSON.stringify(this.playerSettings));\n    },\n    initializeHeroVideo() {\n      const video = this.$refs.heroVideo;\n      if (!video) {\n        console.error('Video element not found');\n        return;\n      }\n      const videoSrc = this.movie.promo_hls_url || this.movie.video_url;\n      if (!videoSrc || !videoSrc.includes('.m3u8')) {\n        console.error('Invalid or missing HLS URL');\n        return;\n      }\n      // Dispose previous player if exists\n      if (this.videojsPlayer) {\n        this.videojsPlayer.dispose();\n      }\n      // Ensure video is muted for autoplay\n      video.muted = true;\n      this.videojsPlayer = videojs(video, {\n        sources: [{\n          src: videoSrc,\n          type: 'application/x-mpegURL'\n        }],\n        controls: true,\n        autoplay: true, // Enable autoplay\n        muted: true,    // Ensure muted for autoplay\n        preload: 'auto',\n        fluid: true\n      });\n      this.videojsPlayer.ready(() => {\n        this.isPromoLoading = false;\n        this.videojsPlayer.muted(true); // Ensure muted\n        this.videojsPlayer.play().catch(e => {\n          console.error('Auto-play prevented:', e);\n        });\n      });\n      this.videojsPlayer.on('error', () => {\n        this.promoVideoError = this.videojsPlayer.error();\n        console.error('Video.js error:', this.promoVideoError);\n      });\n    },\n    onPromoVideoCanPlay() {\n      console.log('Video can play');\n      const video = this.$refs.heroVideo;\n      if (video) {\n        video.play().catch(error => {\n          console.error('Play failed:', error);\n        });\n      }\n    },\n    onPromoVideoLoaded() {\n      console.log('Promo video loaded successfully');\n      this.isPromoLoading = false;\n      const video = this.$refs.heroVideo;\n      if (video) {\n        video.classList.add('playing');\n        // Ensure video is muted and playing\n        video.muted = true;\n        video.play().catch(error => {\n          console.error('Play failed:', error);\n        });\n      }\n    },\n    onPromoVideoWaiting() {\n      console.log('Promo video waiting/buffering');\n      this.isPromoLoading = true;\n    },\n    onPromoVideoPlaying() {\n      this.isPromoPlaying = true;\n      this.isPromoLoading = false;\n      const video = this.$refs.heroVideo;\n      if (video) {\n        video.classList.add('playing');\n      }\n    },\n    handlePromoVideoError(error) {\n      console.error('Promo video error:', error);\n      this.promoVideoError = error;\n      const video = this.$refs.heroVideo;\n      if (video) {\n        video.classList.remove('playing');\n      }\n    },\n    async checkUserSubscription() {\n      try {\n        const phone = localStorage.getItem('phone');\n        if (!phone) return false;\n\n        const response = await axios.get(`${API_BASE_URL}/users/profile/?phone=${phone}`);\n        console.log('Subscription API response:', response.data); // DEBUG\n        if (response.data && response.data.status === 'success') {\n          const user = response.data.user;\n          console.log('User from API:', user); // DEBUG\n          // Check if user has active subscription\n          if (user.is_subscribed && user.subscription_end_date) {\n            const endDate = new Date(user.subscription_end_date);\n            const now = new Date();\n            const isActive = endDate > now;\n            console.log('is_subscribed:', user.is_subscribed, 'endDate:', endDate, 'now:', now, 'isActive:', isActive); // DEBUG\n            return isActive;\n          }\n        }\n        return false;\n      } catch (error) {\n        console.error('Error checking subscription:', error);\n        return false;\n      }\n    },\n    async checkRentalStatus() {\n      try {\n        const phone = localStorage.getItem('phone');\n        if (!phone) return null;\n\n        const response = await axios.get(`${API_BASE_URL}/api/rentals/check/?phone=${phone}&video_id=${this.movie.id}`);\n        if (response.data && response.data.status === 'success') {\n          return response.data.rental;\n        }\n        return null;\n      } catch (error) {\n        console.error('Error checking rental status:', error);\n        return null;\n      }\n    },\n    goToRentalPayment() {\n      this.showRentalPopup = false;\n      this.$router.push(`/movie/${this.movie.id}/rent`);\n    },\n    async playMovie() {\n      try {\n        console.log('playMovie() called - checking video URL');\n        // First check if we have a valid video URL\n        if (!this.movie.hls_url) {\n          throw new Error('No video URL available');\n        }\n\n        // Check user subscription status first\n        const isSubscribed = await this.checkUserSubscription();\n        console.log('User subscription status:', isSubscribed);\n\n        // Rental video logic\n        if (this.movie.video_type === 'rental') {\n          if (isSubscribed) {\n            // Premium user: play directly without showing rental popup\n            console.log('Premium user - playing directly');\n            this.controlsVisible = true;\n            this.isVideoPaused = false;\n            this.isVideoPlaying = true;\n            this.videoUrl = this.movie.hls_url;\n            this.streamType = 'hls';\n            document.body.style.overflow = 'hidden';\n            this.$nextTick(() => {\n              if (this.$refs.videoPlayer) {\n                this.resetControlsTimer();\n              } else {\n                console.error('Video player reference not found');\n                throw new Error('Video player initialization failed');\n              }\n            });\n          } else {\n            // Free user: check rental status\n            console.log('Free user - checking rental status');\n            const rentalInfo = await this.checkRentalStatus();\n            if (rentalInfo && rentalInfo.is_active) {\n              // Rental is active, allow playback\n              console.log('Active rental found - playing video');\n              this.controlsVisible = true;\n              this.isVideoPaused = false;\n              this.isVideoPlaying = true;\n              this.videoUrl = this.movie.hls_url;\n              this.streamType = 'hls';\n              document.body.style.overflow = 'hidden';\n              this.$nextTick(() => {\n                if (this.$refs.videoPlayer) {\n                  this.resetControlsTimer();\n                } else {\n                  console.error('Video player reference not found');\n                  throw new Error('Video player initialization failed');\n                }\n              });\n            } else {\n              // No active rental, redirect to rental page\n              console.log('No active rental - redirecting to rental page');\n              this.$router.push(`/movie/${this.movie.id}/rent`);\n            }\n          }\n          return;\n        }\n\n        // Paid video logic\n        if (this.movie.video_type === 'paid') {\n          if (!isSubscribed) {\n            // If not subscribed, redirect to subscription page\n            this.$router.push({\n              name: 'SubscriptionPlans',\n              query: {\n                redirect: this.$route.fullPath,\n                video_id: this.movie.id\n              }\n            });\n            return;\n          }\n        }\n\n        // Free video or user is subscribed, proceed with playback\n        console.log('Playing free/paid video');\n        this.controlsVisible = true;\n        this.isVideoPaused = false;\n        this.isVideoPlaying = true;\n        this.videoUrl = this.movie.hls_url;\n        this.streamType = 'hls';\n        document.body.style.overflow = 'hidden';\n        this.$nextTick(() => {\n          if (this.$refs.videoPlayer) {\n            this.resetControlsTimer();\n          } else {\n            console.error('Video player reference not found');\n            throw new Error('Video player initialization failed');\n          }\n        });\n      } catch (error) {\n        console.error('Error playing video:', error);\n        this.$store.dispatch('showToast', {\n          message: 'Sorry, the video is not available at the moment. Please try again later.',\n          type: 'error'\n        });\n        this.isVideoPlaying = false;\n        document.body.style.overflow = 'auto';\n      }\n    },\n    closeVideo() {\n      this.isVideoPlaying = false;\n      this.isPlayingPromo = false;\n      \n      // Save the player preferences when closing the player\n      this.savePlayerPreferences();\n      \n      // Restore body scrolling\n      document.body.style.overflow = '';\n    },\n    async toggleWatchlist() {\n      try {\n        // Get authentication state from localStorage\n        const isAuthenticated = localStorage.getItem('isAuthenticated') === 'true';\n        const token = localStorage.getItem('token');\n\n        if (!isAuthenticated || !token) {\n          // Store current path for redirect after login\n          const currentPath = this.$route.fullPath;\n          // Redirect to login with return URL\n          this.$router.push({\n            path: '/login',\n            query: { redirect: currentPath }\n          });\n          return;\n        }\n\n        // Show loading state\n        this.$store.commit('setLoading', true);\n\n        const response = await watchlistAPI.toggle(this.id);\n\n        if (response.data.status === 'success') {\n          this.isInWatchlist = response.data.in_watchlist;\n          // Show success message\n          this.$store.dispatch('showToast', {\n            message: response.data.message,\n            type: 'success'\n          });\n        }\n      } catch (error) {\n        console.error('Error toggling watchlist:', error);\n        // Show error message\n        this.$store.dispatch('showToast', {\n          message: 'Failed to update watchlist. Please try again.',\n          type: 'error'\n        });\n      } finally {\n        this.$store.commit('setLoading', false);\n      }\n    },\n    async checkWatchlistStatus() {\n      try {\n        // Check authentication from localStorage\n        const isAuthenticated = localStorage.getItem('isAuthenticated') === 'true';\n        const token = localStorage.getItem('token');\n\n        if (!isAuthenticated || !token) return;\n\n        const response = await watchlistAPI.getStatus(this.id);\n        this.isInWatchlist = response.data.in_watchlist;\n      } catch (error) {\n        console.error('Error checking watchlist status:', error);\n      }\n    },\n    shareMovie() {\n      // Get the current URL for sharing \n      const shareUrl = this.shareUrl;\n      \n      // Get the best available image URL\n      const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n      \n      // Prepare share data with image\n      const shareData = {\n        title: this.movie.title,\n        text: this.movie.description,\n        url: shareUrl\n      };\n\n      // Add image to share data if available\n      if (imageUrl) {\n        shareData.files = [imageUrl];\n      }\n\n      // Check if Web Share API is supported\n      if (typeof navigator !== 'undefined' && navigator.share && this.isMobileDevice) {\n        // For mobile devices, try to share with image\n        if (imageUrl && navigator.canShare && navigator.canShare(shareData)) {\n          navigator.share(shareData)\n            .then(() => {\n              this.$store.dispatch('showToast', {\n                message: 'Shared successfully with image!',\n                type: 'success'\n              });\n            })\n            .catch((error) => {\n              console.error('Error sharing with image:', error);\n              // Fallback to sharing without image\n              this.shareWithoutImage(shareUrl);\n            });\n        } else {\n          // Fallback to sharing without image\n          this.shareWithoutImage(this.shareUrl);\n        }\n      } else {\n        // Fallback for desktop or unsupported browsers\n        this.showShareDialog = true;\n      }\n    },\n\n    shareWithoutImage(shareUrl) {\n      const shareData = {\n        title: this.movie.title,\n        text: this.movie.description,\n        url: shareUrl\n      };\n\n      navigator.share(shareData)\n        .then(() => {\n          this.$store.dispatch('showToast', {\n            message: 'Shared successfully!',\n            type: 'success'\n          });\n        })\n        .catch((error) => {\n          console.error('Error sharing:', error);\n          this.showShareDialog = true;\n        });\n    },\n    \n    updateMetaTags() {\n      if (!this.movie) return;\n      \n      const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n      const shareUrl = this.shareUrl;\n      const title = this.movie.title;\n      const description = this.movie.description;\n      \n      // Update or create meta tags for Open Graph\n      this.updateMetaTag('og:title', title);\n      this.updateMetaTag('og:description', description);\n      this.updateMetaTag('og:image', imageUrl);\n      this.updateMetaTag('og:url', shareUrl);\n      this.updateMetaTag('og:type', 'video.movie');\n      this.updateMetaTag('og:site_name', 'No1 OTT');\n      \n      // Update or create meta tags for Twitter Card\n      this.updateMetaTag('twitter:card', 'summary_large_image');\n      this.updateMetaTag('twitter:title', title);\n      this.updateMetaTag('twitter:description', description);\n      this.updateMetaTag('twitter:image', imageUrl);\n      this.updateMetaTag('twitter:url', shareUrl);\n      \n      // Update page title\n      document.title = `${title} - No1 OTT`;\n    },\n    \n    updateMetaTag(name, content) {\n      if (!content) return;\n      \n      let meta = document.querySelector(`meta[name=\"${name}\"]`) || \n                 document.querySelector(`meta[property=\"${name}\"]`);\n      \n      if (!meta) {\n        meta = document.createElement('meta');\n        if (name.startsWith('og:')) {\n          meta.setAttribute('property', name);\n        } else {\n          meta.setAttribute('name', name);\n        }\n        document.head.appendChild(meta);\n      }\n      \n      meta.setAttribute('content', content);\n    },\n    toggleSearch() {\n      this.isSearchActive = !this.isSearchActive;\n    },\n    navigateToMovie(movieId) {\n      // Use full page refresh to ensure all components reinitialize\n      window.location.href = `/movie/${movieId}`;\n    },\n    navigateToCategory() {\n      // Navigate to category page with category ID\n      console.log('Navigating to category. Movie data:', this.movie);\n      console.log('Category ID:', this.movie.category_id);\n      console.log('Category:', this.movie.category);\n      \n      const categoryId = this.movie.category_id || this.movie.category;\n      \n      if (categoryId) {\n        console.log('Navigating to category ID:', categoryId);\n        // Use Vue Router for better debugging\n      this.$router.push({\n          name: 'CategoryVideos',\n          params: { id: categoryId }\n      });\n      } else {\n        console.error('No category ID found in movie data');\n        // Show error message to user\n        this.$store.dispatch('showToast', {\n          message: 'Category information not available',\n          type: 'error'\n        });\n      }\n    },\n    goBack() {\n      this.$router.go(-1);\n    },\n    capitalizeText(text) {\n      if (!text) return '';\n      // Split by spaces and special characters\n      return text.split(/[\\s-]+/).map(word => {\n        // Don't change case for special words\n        const specialWords = ['HD', 'UHD', '4K', 'TV', 'II', 'III', 'IV', 'SPY'];\n        if (specialWords.includes(word.toUpperCase())) {\n          return word.toUpperCase();\n        }\n        // Don't change case for articles and conjunctions in middle of title\n        const minorWords = ['a', 'an', 'the', 'and', 'but', 'or', 'for', 'nor', 'in', 'to', 'on', 'at', 'by', 'of'];\n        if (minorWords.includes(word.toLowerCase())) {\n          return word.toLowerCase();\n        }\n        return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();\n      }).join(' ');\n    },\n    async fetchMovieDetails() {\n      try {\n        // Make API call to get movie details\n        const response = await axios.get(`${API_BASE_URL}/api/videos/${this.id}/`);\n        console.log('API Response:', response.data);\n        \n        if (response.data) {\n          // Apply capitalization to title and description\n          this.movie = {\n            ...response.data,\n            title: this.capitalizeText(response.data.title),\n            description: this.capitalizeText(response.data.description)\n          };\n          \n          // Update meta tags for social sharing\n          this.updateMetaTags();\n          \n          // Set video URL based on available formats\n          if (response.data.hls_url) {\n            this.videoUrl = response.data.hls_url;\n            this.streamType = 'hls';\n          } else {\n            throw new Error('No video URL available');\n          }\n          \n          console.log('Set video URL:', this.videoUrl);\n          console.log('Stream type:', this.streamType);\n          \n          // Fetch related videos from same category\n          await this.fetchCategoryVideos();\n          \n          // Fetch recently added videos\n          await this.fetchRecentlyAddedVideos();\n        } else {\n          throw new Error('Invalid response data');\n        }\n      } catch (error) {\n        console.error('Error fetching movie details:', error);\n        this.$store.dispatch('showToast', {\n          message: 'Error loading movie details. Please try again later.',\n          type: 'error'\n        });\n      }\n    },\n    async fetchCategoryVideos() {\n      try {\n        console.log('Fetching category videos for movie:', this.movie);\n        console.log('Category ID:', this.movie.category_id);\n        console.log('Category Name:', this.movie.category_name);\n        \n        if (!this.movie.category_id && !this.movie.category_name) {\n          console.log('No category information available');\n          // Use fallback data\n          this.categoryVideos = this.relatedMovies.slice(0, 8);\n          return;\n        }\n        \n        // Use the correct API endpoint for category videos\n        const categoryId = this.movie.category_id || this.movie.category;\n        if (!categoryId) {\n          console.log('No category ID found');\n          this.categoryVideos = this.relatedMovies.slice(0, 8);\n          return;\n        }\n        \n        const response = await axios.get(`${API_BASE_URL}/api/videos/category/${categoryId}/?page=1&page_size=12`);\n        \n        if (response.data && response.data.status === 'success') {\n          console.log('Category videos API response:', response.data);\n          \n          // Filter out current video from the results\n          let videos = response.data.data || [];\n          videos = videos.filter(video => video.id !== this.movie.id);\n          \n          this.categoryVideos = videos.slice(0, 12).map(video => ({\n            ...video,\n            title: this.capitalizeText(video.title)\n          }));\n          \n          console.log('Processed category videos:', this.categoryVideos);\n        } else {\n          console.log('No API response or invalid status, using fallback data');\n          // Use fallback data\n          this.categoryVideos = this.relatedMovies.slice(0, 8);\n        }\n        \n        // Update scroll buttons after data loads\n        this.$nextTick(() => {\n          this.checkScrollButtons('categoryContainer', 'category');\n        });\n        \n      } catch (error) {\n        console.error('Error fetching category videos:', error);\n        console.log('Using fallback data due to error');\n        // Use fallback data on error\n        this.categoryVideos = this.relatedMovies.slice(0, 8);\n              }\n      },\n      async fetchRecentlyAddedVideos() {\n        try {\n          console.log('Fetching recently added videos');\n          const response = await axios.get(`${API_BASE_URL}/api/videos/`, {\n            params: {\n              ordering: '-created_at',\n              limit: 20\n            }\n          });\n\n          let videos = [];\n          if (response.data) {\n            if (Array.isArray(response.data)) {\n              videos = response.data;\n            } else if (response.data.results) {\n              videos = response.data.results;\n            } else if (response.data.data) {\n              videos = response.data.data;\n            }\n          }\n\n          // Filter out current video from the results\n          videos = videos.filter(video => video.id !== this.movie.id);\n\n          this.recentlyAddedVideos = videos.slice(0, 12).map(video => ({\n            ...video,\n            title: this.capitalizeText(video.title)\n          }));\n\n          console.log('Processed recently added videos:', this.recentlyAddedVideos);\n\n          // Update scroll buttons after data loads\n          this.$nextTick(() => {\n            this.checkScrollButtons('recentlyAddedContainer', 'recentlyAdded');\n          });\n\n        } catch (error) {\n          console.error('Error fetching recently added videos:', error);\n          // Use fallback data on error\n          this.recentlyAddedVideos = this.relatedMovies.slice(0, 8);\n      }\n    },\n    checkDeviceType() {\n      // Check if mobile based on screen width or user agent\n      this.isMobileDevice = window.innerWidth < 768 || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n      \n      // Adjust video control timeout based on device type\n      this.videoInteractionDelay = this.isMobileDevice ? 3500 : 2500; // Mobile needs longer timeout\n    },\n    showControlsOnInteraction() {\n      // Make controls visible on interaction\n      this.controlsVisible = true;\n      \n      // Reset the timeout when there's interaction\n      this.resetControlsTimer();\n    },\n    resetControlsTimer() {\n      // Clear any existing timeout\n      if (this.controlsTimeout) {\n        clearTimeout(this.controlsTimeout);\n      }\n      \n      // If video is playing (not paused), set a timeout to hide controls\n      if (!this.isVideoPaused) {\n        this.controlsTimeout = setTimeout(() => {\n          this.controlsVisible = false;\n        }, this.videoInteractionDelay);\n      }\n    },\n    toggleControlsVisibility(event) {\n      // Prevent default behavior\n      event.preventDefault();\n      \n      // Toggle controls visibility on tap/click (common OTT pattern)\n      this.controlsVisible = !this.controlsVisible;\n      \n      if (this.controlsVisible && !this.isVideoPaused) {\n        // If showing controls and video is playing, reset the timer\n        this.resetControlsTimer();\n      }\n    },\n    onVideoPlay() {\n      this.isVideoPaused = false;\n      this.resetControlsTimer(); // Start the timer to hide controls\n    },\n    onVideoPause() {\n      this.isVideoPaused = true;\n      this.controlsVisible = true; // Always show controls when paused\n      \n      // Clear any existing timeout\n      if (this.controlsTimeout) {\n        clearTimeout(this.controlsTimeout);\n      }\n    },\n    handleVideoError(errorMessage) {\n      console.error('Video playback error:', errorMessage);\n      \n      // If DASH format fails, try falling back to MP4\n      if (this.streamType === 'dash' && this.videoUrl.includes('.mpd')) {\n        this.streamType = 'mp4';\n        this.videoUrl = 'https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8';\n        console.log('Falling back to MP4 format');\n        \n        // Retry with MP4\n        if (this.$refs.videoPlayer) {\n          this.$refs.videoPlayer.retry();\n        }\n      }\n    },\n    checkScrollButtons(containerId, section) {\n      const container = this.$refs[containerId]\n      if (!container) return\n      \n      // Check if we can scroll left\n      this.canScrollLeft[section] = container.scrollLeft > 0\n      \n      // Check if we can scroll right\n      const maxScroll = container.scrollWidth - container.clientWidth\n      this.canScrollRight[section] = container.scrollLeft < maxScroll - 1 // -1 for rounding errors\n    },\n    scrollLeft(containerId) {\n      const container = this.$refs[containerId]\n      if (!container) return\n\n      const cardWidth = containerId === 'categoryContainer' || containerId === 'recentlyAddedContainer' ? 160 : 180 // Adjust based on card width\n      const visibleWidth = container.clientWidth\n      const cardsToScroll = Math.floor(visibleWidth / cardWidth)\n      const scrollAmount = cardWidth * cardsToScroll\n\n      const targetScroll = Math.max(0, container.scrollLeft - scrollAmount)\n      \n      container.scrollTo({\n        left: targetScroll,\n        behavior: 'smooth'\n      })\n    },\n    scrollRight(containerId) {\n      const container = this.$refs[containerId]\n      if (!container) return\n\n      const cardWidth = containerId === 'categoryContainer' || containerId === 'recentlyAddedContainer' ? 160 : 180 // Adjust based on card width\n      const visibleWidth = container.clientWidth\n      const cardsToScroll = Math.floor(visibleWidth / cardWidth)\n      const scrollAmount = cardWidth * cardsToScroll\n\n      const maxScroll = container.scrollWidth - container.clientWidth\n      const targetScroll = Math.min(maxScroll, container.scrollLeft + scrollAmount)\n      \n      container.scrollTo({\n        left: targetScroll,\n        behavior: 'smooth'\n      })\n    },\n    handleScroll() {\n      const header = document.querySelector('.header-with-gradient')\n      if (header) {\n        if (window.scrollY > 50) {\n          header.classList.add('scrolled')\n        } else {\n          header.classList.remove('scrolled')\n        }\n      }\n    },\n    // Handle subscription payment\n    handleSubscribe() {\n      // Close the payment popup\n      this.showPaymentPopup = false;\n      // Redirect to subscription plans page\n      this.$router.push({\n        name: 'SubscriptionPlans',\n        query: { \n          redirect: this.$route.fullPath, // Store current movie page URL\n          video_id: this.movie.id // Pass video ID\n        }\n      });\n    },\n    // Close payment popup\n    closePaymentPopup() {\n      this.showPaymentPopup = false;\n    },\n    handlePromoVideoEnd() {\n      console.log('Promo video ended');\n      const video = this.$refs.heroVideo;\n      if (video) {\n        // Reset to beginning and play again\n        video.currentTime = 0;\n        video.play().catch(error => {\n          console.log('Error replaying promo video:', error);\n        });\n      }\n      this.isPromoPlaying = false;\n    },\n    // Helper to initialize or update video.js player for promo/main video\n    initVideoJsPlayer(videoEl, videoSrc) {\n      if (!videoEl) return;\n      // Only initialize if not already initialized\n      if (!videoEl._videojsPlayer) {\n        videoEl._videojsPlayer = videojs(videoEl, {\n          controls: true,\n          autoplay: true,\n          muted: true,\n          preload: 'auto',\n          fluid: true\n        });\n        videoEl._videojsPlayer.on('error', () => {\n          this.promoVideoError = videoEl._videojsPlayer.error();\n          console.error('Video.js error:', this.promoVideoError);\n        });\n      }\n      // Only update source if changed\n      if (videoEl._videojsPlayer.currentSrc() !== videoSrc) {\n        videoEl._videojsPlayer.src({ src: videoSrc, type: 'application/x-mpegURL' });\n      }\n      // Reset playing state before playback\n      this.isPromoPlaying = false;\n      videoEl._videojsPlayer.off('playing'); // Remove previous listeners\n      videoEl._videojsPlayer.on('playing', () => {\n        this.isPromoPlaying = true;\n        this.$forceUpdate(); // Ensure Vue reactivity\n        console.log('video.js playing event fired, isPromoPlaying set to true');\n      });\n      videoEl._videojsPlayer.ready(() => {\n        videoEl._videojsPlayer.muted(true);\n        videoEl._videojsPlayer.play().then(() => {\n          console.log('Video should be playing');\n          console.log('Player state:', videoEl._videojsPlayer.paused(), videoEl._videojsPlayer.currentSrc());\n        }).catch(e => {\n          console.error('Auto-play prevented:', e);\n        });\n      });\n      // Add native error event logging\n      videoEl.addEventListener('error', (e) => {\n        console.error('Native video error:', e);\n      });\n    },\n    async playPromo() {\n      try {\n        if (!this.movie.promo_hls_url) {\n          throw new Error('No promo video URL available');\n        }\n        this.controlsVisible = true;\n        this.isVideoPaused = false;\n        this.isVideoPlaying = true;\n        this.isPlayingPromo = true;\n        this.videoUrl = this.movie.promo_hls_url;\n        this.streamType = 'hls';\n        document.body.style.overflow = 'hidden';\n        this.$nextTick(() => {\n          const video = this.$refs.heroVideo;\n          if (video) {\n            video.muted = true;\n            this.initVideoJsPlayer(video, this.movie.promo_hls_url);\n          } else {\n            throw new Error('Video player initialization failed');\n          }\n        });\n      } catch (error) {\n        console.error('Error playing promo video:', error);\n        this.promoHasError = true; // Hide promo button on error\n        this.$store.dispatch('showToast', {\n          message: 'Sorry, the promo video is not available at the moment. Please try again later.',\n          type: 'error'\n        });\n        this.isVideoPlaying = false;\n        this.isPlayingPromo = false;\n        document.body.style.overflow = 'auto';\n      }\n    },\n    shareToWhatsApp() {\n      const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n      const text = `Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`;\n      \n      // For WhatsApp, we need to use a different approach for image sharing\n      if (imageUrl && this.isMobileDevice) {\n        // Try to use native sharing with image for mobile devices\n        const shareData = {\n          title: this.movie.title,\n          text: text,\n          url: this.shareUrl,\n          files: [imageUrl]\n        };\n        \n        if (navigator.canShare && navigator.canShare(shareData)) {\n          navigator.share(shareData)\n            .then(() => {\n              this.$store.dispatch('showToast', {\n                message: 'Shared to WhatsApp with image!',\n                type: 'success'\n              });\n            })\n            .catch((error) => {\n              console.error('WhatsApp share error:', error);\n              // Fallback to text-only WhatsApp sharing\n              this.shareToWhatsAppTextOnly(text);\n            });\n        } else {\n          // Fallback to text-only WhatsApp sharing\n          this.shareToWhatsAppTextOnly(text);\n        }\n      } else {\n        // Desktop or no image available - use text-only sharing\n        this.shareToWhatsAppTextOnly(text);\n      }\n      \n      this.showShareDialog = false;\n    },\n\n    shareToWhatsAppTextOnly(text) {\n      // Use the share URL directly to trigger rich preview\n      const shareText = `${text}\\n\\n${this.shareUrl}`;\n      const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(shareText)}`;\n      if (typeof window !== 'undefined') {\n        window.open(whatsappUrl, '_blank');\n      }\n    },\n\n    // Alternative method for WhatsApp image sharing using canvas\n    async shareToWhatsAppWithImage() {\n      try {\n        const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n        \n        if (!imageUrl) {\n          this.shareToWhatsAppTextOnly(`Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`);\n          return;\n        }\n\n        // Create a canvas with the image and text overlay\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        \n        // Set canvas size\n        canvas.width = 600;\n        canvas.height = 400;\n        \n        // Load the image\n        const img = new Image();\n        img.crossOrigin = 'anonymous';\n        \n        img.onload = () => {\n          // Draw the image\n          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n          \n          // Add a semi-transparent overlay for text readability\n          ctx.fillStyle = 'rgba(0, 0, 0, 0.6)';\n          ctx.fillRect(0, canvas.height - 120, canvas.width, 120);\n          \n          // Add text\n          ctx.fillStyle = 'white';\n          ctx.font = 'bold 24px Arial';\n          ctx.textAlign = 'center';\n          ctx.fillText(this.movie.title, canvas.width / 2, canvas.height - 80);\n          \n          ctx.font = '16px Arial';\n          ctx.fillText('Watch on No1 OTT', canvas.width / 2, canvas.height - 50);\n          \n          // Convert canvas to blob\n          canvas.toBlob((blob) => {\n            if (blob) {\n              // Create a file from the blob\n              const file = new File([blob], 'movie-share.jpg', { type: 'image/jpeg' });\n              \n              // Try to share with the generated image\n              const shareData = {\n                title: this.movie.title,\n                text: `Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.shareUrl}`,\n                files: [file]\n              };\n              \n              if (navigator.canShare && navigator.canShare(shareData)) {\n                navigator.share(shareData)\n                  .then(() => {\n                    this.$store.dispatch('showToast', {\n                      message: 'Shared to WhatsApp with image!',\n                      type: 'success'\n                    });\n                  })\n                  .catch((error) => {\n                    console.error('WhatsApp share error:', error);\n                    this.shareToWhatsAppTextOnly(`Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`);\n                  });\n              } else {\n                this.shareToWhatsAppTextOnly(`Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`);\n              }\n            }\n          }, 'image/jpeg', 0.8);\n        };\n        \n        img.onerror = () => {\n          // If image fails to load, fallback to text-only\n          this.shareToWhatsAppTextOnly(`Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`);\n        };\n        \n        img.src = imageUrl;\n        \n      } catch (error) {\n        console.error('Error creating WhatsApp image share:', error);\n        this.shareToWhatsAppTextOnly(`Check out \"${this.movie.title}\" on No1 OTT!\\n\\n${this.movie.description}\\n\\n${this.shareUrl}`);\n      }\n    },\n    shareToFacebook() {\n      const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n      let facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(this.shareUrl)}`;\n      \n      // Add image URL to Facebook share if available\n      if (imageUrl) {\n        facebookUrl += `&picture=${encodeURIComponent(imageUrl)}`;\n      }\n      \n      if (typeof window !== 'undefined') {\n        window.open(facebookUrl, '_blank');\n      }\n      this.showShareDialog = false;\n    },\n    shareToTwitter() {\n      const imageUrl = this.movie.thumbnail_url || this.movie.portrait_thumbnail_url || this.movie.poster_url;\n      const text = `Check out \"${this.movie.title}\" on No1 OTT!`;\n      let twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(this.shareUrl)}`;\n      \n      // Add image URL to Twitter share if available\n      if (imageUrl) {\n        twitterUrl += `&image=${encodeURIComponent(imageUrl)}`;\n      }\n      \n      if (typeof window !== 'undefined') {\n        window.open(twitterUrl, '_blank');\n      }\n      this.showShareDialog = false;\n    },\n    async copyShareLink() {\n      if (typeof navigator === 'undefined') return;\n      \n      try {\n        await navigator.clipboard.writeText(this.shareUrl);\n        this.copyStatus = 'Copied!';\n        \n        // Show success toast\n        this.$store.dispatch('showToast', {\n          message: 'Link copied to clipboard!',\n          type: 'success'\n        });\n\n        // Reset copy status after 2 seconds\n        setTimeout(() => {\n          this.copyStatus = 'Copy';\n        }, 2000);\n      } catch (err) {\n        console.error('Failed to copy:', err);\n        \n        // Fallback for older browsers\n        if (this.$refs.shareLink) {\n          this.$refs.shareLink.select();\n          document.execCommand('copy');\n          \n          this.copyStatus = 'Copied!';\n          setTimeout(() => {\n            this.copyStatus = 'Copy';\n          }, 2000);\n        }\n      }\n    }\n  }\n};\n</script>\n\n<style scoped>\n/* Advanced Video Player modal - Full screen */\n.advanced-video-player-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #000;\n  z-index: 100;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  /* Remove overflow: hidden to allow centering */\n}\n\n:deep(.video-element) {\n  width: 100vw !important;\n  height: 100vh !important;\n  max-width: 100vw;\n  max-height: 100vh;\n  aspect-ratio: 16 / 9;\n  object-fit: contain !important;\n  background: #000;\n  display: block;\n  margin: 0 auto;\n}\n\n@media (max-width: 768px) {\n  .advanced-video-player-modal {\n    padding: 0;\n    width: 100vw;\n    height: 100vh;\n    min-width: 100vw;\n    min-height: 100vh;\n  }\n  :deep(.video-element) {\n    width: 100vw !important;\n    height: 100vh !important;\n    aspect-ratio: 16 / 9;\n    object-fit: contain !important;\n    background: #000;\n  }\n}\n\n/* Container fix for horizontal scrolling */\n.movie-details-wrapper {\n  position: relative;\n  overflow-x: hidden;\n  width: 100%;\n  max-width: 100vw;\n}\n\n/* Header gradient overlay to blend with movie backdrop */\n.header-with-gradient {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 30;\n  background: linear-gradient(to bottom, \n    rgba(0, 0, 0, 0.9) 0%,\n    rgba(0, 0, 0, 0.7) 60%,\n    rgba(0, 0, 0, 0.4) 80%,\n    rgba(0, 0, 0, 0) 100%);\n  height: 120px;\n  transition: background 0.3s ease;\n}\n\n.header-with-gradient.scrolled {\n  background: #121212;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);\n}\n\n/* Make the header background transparent by default */\n.header-with-gradient :deep(.header) {\n  background: transparent !important;\n  transition: background 0.3s ease;\n}\n\n.header-with-gradient.scrolled :deep(.header) {\n  background: #121212 !important;\n  backdrop-filter: blur(10px);\n}\n\n.movie-detail-container {\n  position: relative;\n  height: 100vh;\n  min-height: 600px;\n  max-height: 800px;\n  padding-top: 0;\n  overflow: hidden;\n  width: 100%;\n}\n\n/* Back button styling */\n.back-btn {\n  position: absolute;\n  top: 1rem;\n  left: 1rem;\n  z-index: 20;\n  background: rgba(0, 0, 0, 0.5);\n  color: white;\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  display: none; /* Hidden by default (desktop) */\n  align-items: center;\n  justify-content: center;\n  border: none;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.back-btn:hover {\n  background: rgba(0, 0, 0, 0.7);\n}\n\n/* Unified action buttons styling inspired by major OTT platforms */\n.action-buttons {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  margin: 1.5rem 0;\n  flex-wrap: wrap;\n}\n\n.play-button {\n  background: linear-gradient(45deg, #c30059, #ff0062);\n  color: white;\n  font-weight: 600;\n  border-radius: 8px;\n  transition: all 0.3s ease;\n  box-shadow: 0 4px 15px rgba(195, 0, 89, 0.3);\n  position: relative;\n  overflow: hidden;\n  white-space: nowrap;    \n  width: auto;             \n  min-width: unset;        \n  max-width: unset;         \n  display: inline-flex;     \n  align-items: center;\n  justify-content: center;\n  padding: 8px 16px;        \n  gap: 8px;\n}\n\n.play-button::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(45deg, rgba(255,255,255,0.1), rgba(255,255,255,0));\n  transform: translateX(-100%) rotate(45deg);\n  transition: transform 0.6s ease;\n}\n\n.play-button:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 20px rgba(195, 0, 89, 0.4);\n}\n\n.play-button:hover::before {\n  transform: translateX(100%) rotate(45deg);\n}\n\n.play-button:active {\n  transform: translateY(0);\n  box-shadow: 0 4px 15px rgba(195, 0, 89, 0.3);\n}\n\n.play-button i {\n  font-size: 1.1rem;\n}\n\n/* Promo button with glass effect */\nbutton[class*=\"play-button\"]:first-child {\n  background: rgba(255, 255, 255, 0.1);\n  backdrop-filter: blur(10px);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n}\n\nbutton[class*=\"play-button\"]:first-child:hover {\n  background: rgba(255, 255, 255, 0.15);\n  border-color: rgba(255, 255, 255, 0.3);\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);\n}\n\nbutton[class*=\"play-button\"]:first-child:active {\n  transform: translateY(0);\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);\n}\n\n/* Mobile responsive styles */\n@media (max-width: 768px) {\n  .action-buttons {\n    gap: 0.75rem;\n    margin: 1rem 0;\n  }\n\n  .play-button {\n    padding: 0.75rem 1.5rem;\n    min-width: 120px;\n    font-size: 0.9rem;\n  }\n\n  .play-button i {\n    font-size: 1rem;\n  }\n\n  /* Stack buttons on very small screens */\n  @media (max-width: 360px) {\n    .action-buttons {\n      flex-direction: column;\n      width: 100%;\n    }\n\n    .play-button {\n      width: 100%;\n      justify-content: center;\n    }\n  }\n}\n\n/* Add shine animation for play button */\n@keyframes shine {\n  0% {\n    background-position: 200% center;\n  }\n  100% {\n    background-position: -200% center;\n  }\n}\n\n.play-button.main-play {\n  background: linear-gradient(45deg, #c30059, #ff0062, #c30059);\n  background-size: 200% auto;\n  animation: shine 8s linear infinite;\n}\n\n.action-button {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n  border-radius: 0.25rem;\n  width: 60px;\n  height: 60px;\n  padding: 0.75rem 0;\n  transition: all 0.2s;\n}\n\n.action-button:hover {\n  background: rgba(255, 255, 255, 0.2);\n}\n\n.action-button i {\n  font-size: 1.25rem;\n  margin-bottom: 0.25rem;\n}\n\n.action-label {\n  font-size: 0.7rem;\n}\n\n/* Section carousel styling to match Home page */\n.scroll-container {\n  scroll-behavior: smooth;\n  -webkit-overflow-scrolling: touch;\n  width: 100%;\n}\n\n.scrollbar-hide::-webkit-scrollbar {\n  display: none;\n}\n\n.scrollbar-hide {\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n}\n\n/* Main content section fixes */\nmain {\n  position: relative;\n  overflow-x: hidden;\n  width: 100%;\n  box-sizing: border-box;\n  max-width: 100%;\n}\n\n/* Gradient text style for section headings */\n.gradient-text {\n  background: linear-gradient(45deg, #fff 30%, rgba(255, 255, 255, 0.8));\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n}\n\n/* Scroll buttons */\n.scroll-button {\n  position: absolute;\n  top: 50%;\n  transform: translateY(-50%);\n  z-index: 10;\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  background-color: #c30059;\n  color: white;\n  display: none;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);\n  transition: all 0.2s;\n}\n\n.scroll-button:hover {\n  transform: translateY(-50%) scale(1.1);\n  background-color: #a80048;\n}\n\n.left-scroll-button {\n  left: -18px;\n}\n\n.right-scroll-button {\n  right: 0;\n}\n\n@media (min-width: 768px) {\n  .scroll-button {\n    display: flex;\n  }\n}\n\n/* Scroll button container fix */\nsection {\n  position: relative;\n  width: 100%;\n  overflow-x: hidden;\n}\n\n/* Cast card styling */\n.cast-card {\n  min-width: 150px;\n  max-width: 150px;\n  flex-shrink: 0;\n}\n\n.cast-image {\n  width: 100%;\n  aspect-ratio: 2/3;\n  border-radius: 0.5rem;\n  overflow: hidden;\n  margin-bottom: 0.5rem;\n}\n\n.cast-image img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  transition: transform 0.3s ease;\n}\n\n.cast-card:hover img {\n  transform: scale(1.05);\n}\n\n.cast-name {\n  font-size: 0.95rem;\n  font-weight: 600;\n  margin-bottom: 0.25rem;\n}\n\n.cast-role {\n  font-size: 0.8rem;\n  color: rgba(255, 255, 255, 0.7);\n}\n\n/* Related movie card styling */\n.related-movie-card {\n  min-width: 160px;\n  max-width: 160px;\n  flex-shrink: 0;\n  cursor: pointer;\n}\n\n.card-container {\n  width: 100%;\n  max-width: 160px;\n  height: 240px;\n  transition: transform 0.3s ease;\n  cursor: pointer;\n  background-color: #1d1d1d;\n}\n\n.related-movie-card:hover .card-container {\n  transform: translateY(-8px) scale(1.05);\n  z-index: 10;\n}\n\n.related-movie-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.card-text {\n  transition: transform 0.3s ease;\n}\n\n.related-movie-card:hover .card-text {\n  transform: scale(1.1);\n}\n\n/* Mobile-only elements */\n.mobile-only-element {\n  display: none; /* Hidden by default */\n}\n\n/* Hide elements on mobile */\n.hide-on-mobile {\n  display: block;\n}\n\n/* Media query for mobile devices */\n@media (max-width: 768px) {\n  .mobile-only-element {\n    display: flex; /* Show on mobile */\n  }\n  \n  .hide-on-mobile {\n    display: none; /* Hide on mobile */\n  }\n  \n  .movie-detail-container {\n    padding-top: 0; /* Remove padding since header is hidden */\n  }\n  \n  /* Additional mobile-specific styles */\n  .movie-backdrop {\n    height: 70vh; /* Increase height for portrait view */\n  }\n\n  /* Mobile action buttons styling */\n  .action-buttons {\n    margin-top: 0.25rem;\n    margin-bottom: 0.25rem;\n  }\n  \n  .play-button, .promo-button {\n    flex: 1;\n    padding: 0.75rem 1rem;\n  }\n  \n  .action-button {\n    width: 48px;\n    height: 48px;\n  }\n  \n  .action-label {\n    display: none; /* Hide labels on mobile for cleaner UI */\n  }\n\n  main {\n    padding-top: 0;\n    padding-bottom: 0;\n  }\n\n  section {\n    margin-bottom: 0.25rem;\n  }\n\n  .movie-info-container {\n    padding: 0.75rem;\n    padding-top: calc(40vh);\n  }\n\n  .movie-description {\n    margin-bottom: 0.5rem;\n  }\n\n  .movie-meta {\n    margin-bottom: 0.25rem;\n  }\n\n  .movie-tags {\n    margin-bottom: 0.25rem;\n  }\n\n  .movie-badges {\n    margin-bottom: 0.25rem;\n  }\n\n  .movie-title {\n    margin-bottom: 0.25rem;\n  }\n}\n\n.movie-backdrop {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 0;\n  overflow: hidden;\n  background: #121212;\n  \n  @media (max-width: 768px) {\n    height: 70vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: #000;\n  }\n}\n\n.backdrop-image {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  transform: scale(1.1);\n  opacity: 1;\n  transition: opacity 0.5s ease;\n  will-change: opacity;\n  backface-visibility: hidden;\n  -webkit-backface-visibility: hidden;\n}\n\n.video-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n}\n\n.backdrop-video {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  transform: scale(1.1);\n  opacity: 0;\n  transition: opacity 0.5s ease;\n  will-change: opacity;\n  backface-visibility: hidden;\n  -webkit-backface-visibility: hidden;\n}\n\n.backdrop-video.playing {\n  opacity: 1;\n}\n\n/* When video is playing, fade out the thumbnail */\n.backdrop-video.playing + .backdrop-image {\n  opacity: 0;\n}\n\n/* Loading spinner for video */\n.video-loading {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 3;\n  width: 40px;\n  height: 40px;\n  border: 3px solid rgba(255, 255, 255, 0.3);\n  border-radius: 50%;\n  border-top-color: #fff;\n  animation: spin 1s ease-in-out infinite;\n}\n\n@keyframes spin {\n  to { transform: translate(-50%, -50%) rotate(360deg); }\n}\n\n.backdrop-gradient {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(\n    to bottom,\n    rgba(18, 18, 18, 0.3) 0%,\n    rgba(18, 18, 18, 0.7) 50%,\n    rgba(18, 18, 18, 1) 100%\n  );\n  z-index: 2;\n  pointer-events: none;\n}\n\n.movie-info-container {\n  position: relative;\n  z-index: 10;\n  padding: 2rem;\n  padding-top: calc(50vh);\n  max-width: 800px;\n}\n\n.movie-badges {\n  display: flex;\n  gap: 0.5rem;\n  margin-bottom: 0.75rem;\n}\n\n.badge {\n  font-size: 0.75rem;\n  padding: 0.25rem 0.5rem;\n  border-radius: 0.25rem;\n  font-weight: 600;\n  text-transform: uppercase;\n  display: inline-flex;\n  align-items: center;\n}\n\n.premium {\n  background: linear-gradient(45deg, #c30059, #ff0062);\n  padding: 0.4rem 0.8rem;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  text-transform: uppercase;\n  font-size: 0.8rem;\n  letter-spacing: 0.5px;\n  border-radius: 4px;\n  box-shadow: 0 2px 4px rgba(195, 0, 89, 0.3);\n  transition: all 0.3s ease;\n}\n\n.premium:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 4px 8px rgba(195, 0, 89, 0.4);\n}\n\n.premium i {\n  font-size: 0.9rem;\n  color: #FFD700;\n}\n\n.premium-price {\n  color: #c30059;\n  font-weight: 600;\n  background: rgba(195, 0, 89, 0.1);\n  padding: 0.2rem 0.6rem;\n  border-radius: 4px;\n  font-size: 0.85rem;\n}\n\n.quality {\n  background-color: #0066cc;\n}\n\n.movie-title {\n  font-size: 2.5rem;\n  font-weight: 700;\n  margin-bottom: 0.5rem;\n}\n\n.movie-meta {\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n  margin-bottom: 1rem;\n  font-size: 0.875rem;\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.dot-divider {\n  display: inline-block;\n  width: 4px;\n  height: 4px;\n  border-radius: 50%;\n  background-color: rgba(255, 255, 255, 0.5);\n}\n\n.movie-tags {\n  display: flex;\n  gap: 0.5rem;\n  margin-bottom: 1rem;\n}\n\n.tag {\n  font-size: 0.75rem;\n  padding: 0.25rem 0.5rem;\n  border-radius: 1rem;\n  background-color: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.movie-description {\n  font-size: 0.95rem;\n  line-height: 1.6;\n  margin-bottom: 1.5rem;\n  color: rgba(255, 255, 255, 0.9);\n  max-width: 700px;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n@media (max-width: 768px) {\n  .movie-description {\n    font-size: 0.9rem;\n    line-height: 1.5;\n    margin-bottom: 0.5rem;\n  }\n}\n\n/* Mobile Search Bar */\n.mobile-search-bar {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 60px;\n  background-color: #121212;\n  z-index: 100;\n  display: flex;\n  align-items: center;\n  padding: 0 1rem;\n  transform: translateY(-100%);\n  transition: transform 0.3s ease;\n}\n\n.mobile-search-bar.active {\n  transform: translateY(0);\n}\n\n.mobile-search-bar input {\n  flex: 1;\n  background-color: rgba(255, 255, 255, 0.1);\n  border: none;\n  color: white;\n  padding: 0.75rem 1rem;\n  border-radius: 4px;\n}\n\n.mobile-search-bar input:focus {\n  outline: none;\n  background-color: rgba(255, 255, 255, 0.15);\n}\n\n.mobile-search-bar button {\n  padding: 0.5rem;\n  margin-left: 0.5rem;\n}\n\n/* Mobile responsive styles */\n@media (max-width: 768px) {\n  .movie-detail-container {\n    height: auto;\n    max-height: none;\n    padding-bottom: 20px; /* Reduced bottom padding */\n  }\n  \n  .movie-title {\n    font-size: 1.75rem;\n  }\n}\n\n/* Additional responsive fixes */\n@media (min-width: 769px) {\n  main {\n    padding-right: 10px;\n    padding-left: 10px;\n    max-width: 100vw;\n  }\n  \n  .scroll-button {\n    z-index: 20;\n  }\n  \n  .right-scroll-button {\n    right: 10px;\n  }\n  \n  .left-scroll-button {\n    left: -10px;\n  }\n  \n  .carousel-container {\n    padding-right: 10px;\n  }\n}\n\n/* Fix for the carousel to prevent overflow */\nsection > div:first-child {\n  padding-right: 1rem;\n  box-sizing: border-box;\n  width: 100%;\n}\n\n/* Fix for the last visible elements in carousels */\n.scroll-container > div {\n  padding-right: 1rem;\n  box-sizing: border-box;\n}\n\n/* Carousel container fixes */\n.carousel-container {\n  width: 100%;\n  box-sizing: border-box;\n  overflow: hidden;\n}\n\n.carousel-inner-container {\n  width: fit-content;\n  padding-bottom: 1rem; /* Add space for potential scrollbar */\n}\n\n/* Payment Popup */\n.payment-popup-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.85);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  padding: 1rem;\n  backdrop-filter: blur(8px);\n}\n\n.payment-popup {\n  background-color: #1a1a1a;\n  border-radius: 16px;\n  width: 100%;\n  max-width: 480px;\n  overflow: hidden;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.popup-header {\n  padding: 1.5rem;\n  background: linear-gradient(to right, #c30059, #7c1d44);\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.premium-badge {\n  width: 40px;\n  height: 40px;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.premium-badge i {\n  font-size: 1.25rem;\n  color: white;\n}\n\n.close-button {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  background: rgba(255, 255, 255, 0.2);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  transition: all 0.2s;\n}\n\n.close-button:hover {\n  background: rgba(255, 255, 255, 0.3);\n  transform: scale(1.1);\n}\n\n.popup-content {\n  padding: 1.5rem;\n}\n\n.movie-preview {\n  background: rgba(0, 0, 0, 0.3);\n  border-radius: 12px;\n  padding: 1rem;\n  display: flex;\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n}\n\n.popup-thumbnail {\n  width: 120px;\n  height: 68px;\n  object-fit: cover;\n  border-radius: 8px;\n}\n\n.movie-info {\n  flex: 1;\n}\n\n.movie-title {\n  font-size: 1.1rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n  color: white;\n}\n\n.premium-features {\n  background: rgba(195, 0, 89, 0.05);\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n}\n\n.features-grid {\n  display: grid;\n  gap: 1rem;\n}\n\n.feature-item {\n  display: flex;\n  gap: 1rem;\n  align-items: flex-start;\n}\n\n.feature-item i {\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(195, 0, 89, 0.1);\n  border-radius: 6px;\n}\n\n.subscribe-button {\n  width: 100%;\n  background: linear-gradient(to right, #c30059, #7c1d44);\n  color: white;\n  font-weight: 600;\n  padding: 1rem;\n  border-radius: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n  transition: all 0.2s;\n}\n\n.subscribe-button:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 10px 20px -10px rgba(195, 0, 89, 0.5);\n}\n\n.subscribe-button:active {\n  transform: translateY(0);\n}\n\n@media (max-width: 480px) {\n  .payment-popup {\n    max-height: 90vh;\n    overflow-y: auto;\n  }\n\n  .popup-content {\n    padding: 1rem;\n  }\n\n  .movie-preview {\n    flex-direction: column;\n    align-items: center;\n    text-align: center;\n  }\n\n  .popup-thumbnail {\n    width: 100%;\n    height: auto;\n    aspect-ratio: 16/9;\n  }\n\n  .premium-features {\n    padding: 1rem;\n  }\n}\n\n/* Add these new styles for portrait mobile */\n.backdrop-image.portrait-mobile {\n  @media (max-width: 768px) {\n    object-fit: contain;\n    object-position: center;\n    height: 100%;\n    width: 100%;\n    background-color: #000;\n  }\n}\n\n.secondary-button {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n  padding: 0.75rem 1.5rem;\n  border-radius: 8px;\n  border: 2px solid rgba(255, 255, 255, 0.2);\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: all 0.3s ease;\n}\n\n.secondary-button:hover {\n  background: rgba(255, 255, 255, 0.2);\n  border-color: rgba(255, 255, 255, 0.3);\n}\n\n.secondary-button.in-watchlist {\n  background: rgba(255, 119, 0, 0.2);\n  border-color: rgba(255, 119, 0, 0.4);\n}\n\n.secondary-button.in-watchlist:hover {\n  background: rgba(255, 119, 0, 0.3);\n  border-color: rgba(255, 119, 0, 0.5);\n}\n\n/* Add these new styles for share dialog */\n.backdrop-blur-sm {\n  backdrop-filter: blur(8px);\n}\n\n@media (max-width: 640px) {\n  .grid-cols-2 {\n    grid-template-columns: 1fr;\n  }\n}\n\n/* Debug: Force video to be visible and sized correctly */\n.backdrop-video {\n  display: block !important;\n  opacity: 1 !important;\n  height: 100vh !important;\n  width: 100vw !important;\n  z-index: 1000 !important;\n}\n\n/* Remove video.js fluid aspect ratio padding */\n.vjs-fluid {\n  padding-top: 0 !important;\n  height: 100% !important;\n  min-height: 0 !important;\n}\n\n/* Hide video.js text information but keep controls */\n:deep(.video-js) {\n  .vjs-time-control,\n  .vjs-remaining-time,\n  .vjs-duration,\n  .vjs-current-time,\n  .vjs-time-divider {\n    display: none !important;\n  }\n\n  .vjs-progress-control {\n    height: 3px !important;\n    opacity: 0.5;\n    transition: all 0.3s;\n  }\n\n  .vjs-progress-control:hover {\n    height: 6px !important;\n    opacity: 1;\n  }\n\n  .vjs-control-bar {\n    background: linear-gradient(to top, rgba(0,0,0,0.7), transparent) !important;\n    height: 60px !important;\n    padding-bottom: 10px !important;\n  }\n}\n\n/* Video container and video element styles */\n.video-container {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: #000;\n}\n\n.backdrop-video {\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  display: block;\n  margin: 0 auto;\n  background: #000;\n}\n\n/* Desktop specific styles */\n@media (min-width: 769px) {\n  .video-container {\n    height: 100vh !important;\n    max-height: 100vh !important;\n  }\n\n  .backdrop-video {\n    height: 100vh !important;\n    max-height: 100vh !important;\n  }\n\n  :deep(.video-js) {\n    width: 100% !important;\n    height: 100vh !important;\n    max-height: 100vh !important;\n  }\n\n  :deep(.vjs-tech) {\n    height: 100vh !important;\n    max-height: 100vh !important;\n    object-fit: contain !important;\n  }\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}