{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, vModelText as _vModelText, normalizeClass as _normalizeClass, withDirectives as _withDirectives, toDisplayString as _toDisplayString, withModifiers as _withModifiers } from \"vue\";\nimport _imports_0 from '@/assets/ott.jpg';\nconst _hoisted_1 = {\n  class: \"min-h-screen bg-[#121212] flex items-center justify-center px-4\"\n};\nconst _hoisted_2 = {\n  class: \"w-full max-w-md\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"mb-4 bg-gradient-to-r from-green-500/20 to-green-600/20 border border-green-500/30 rounded-lg p-3 text-green-400 text-sm flex items-center gap-2\"\n};\nconst _hoisted_4 = {\n  class: \"grid grid-cols-2 gap-4\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"mt-1 text-[#ff4d4d] text-sm\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"mt-1 text-[#ff4d4d] text-sm\"\n};\nconst _hoisted_7 = {\n  key: 0,\n  class: \"mt-1 text-[#ff4d4d] text-sm\"\n};\nconst _hoisted_8 = {\n  class: \"flex gap-2\"\n};\nconst _hoisted_9 = [\"disabled\"];\nconst _hoisted_10 = {\n  key: 0\n};\nconst _hoisted_11 = {\n  key: 1\n};\nconst _hoisted_12 = {\n  key: 0,\n  class: \"mt-1 text-[#ff4d4d] text-sm\"\n};\nconst _hoisted_13 = {\n  key: 1,\n  class: \"mt-1 text-green-500 text-sm flex items-center gap-1\"\n};\nconst _hoisted_14 = {\n  key: 2,\n  class: \"mt-1 text-[#ff4d4d] text-sm flex items-center gap-1\"\n};\nconst _hoisted_15 = [\"disabled\"];\nconst _hoisted_16 = {\n  key: 0\n};\nconst _hoisted_17 = {\n  key: 1,\n  class: \"flex items-center justify-center\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createCommentVNode(\" Auto-filled Referral Alert \"), $setup.autoFilledReferral && $setup.referralSuccess ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, _cache[6] || (_cache[6] = [_createElementVNode(\"i\", {\n    class: \"fas fa-info-circle text-green-400\"\n  }, null, -1 /* HOISTED */), _createElementVNode(\"span\", null, \"Referral code was automatically applied from your invitation link!\", -1 /* HOISTED */)]))) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Logo \"), _cache[15] || (_cache[15] = _createElementVNode(\"div\", {\n    class: \"text-center mb-8\"\n  }, [_createElementVNode(\"img\", {\n    src: _imports_0,\n    alt: \"Logo\",\n    class: \"h-12 mx-auto mb-4\"\n  }), _createElementVNode(\"h1\", {\n    class: \"text-2xl font-bold text-white\"\n  }, \"Complete Your Profile\"), _createElementVNode(\"p\", {\n    class: \"text-white/60 mt-2\"\n  }, \"Just a few more details to get started\")], -1 /* HOISTED */)), _createCommentVNode(\" Mini Registration Form \"), _createElementVNode(\"form\", {\n    onSubmit: _cache[5] || (_cache[5] = _withModifiers((...args) => $setup.handleSubmit && $setup.handleSubmit(...args), [\"prevent\"])),\n    class: \"space-y-6\"\n  }, [_createCommentVNode(\" Name Fields \"), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", null, [_cache[7] || (_cache[7] = _createElementVNode(\"label\", {\n    class: \"block text-white/90 text-sm mb-2\"\n  }, [_createTextVNode(\" First Name \"), _createElementVNode(\"span\", {\n    class: \"text-[#ff4d4d]\"\n  }, \"*\")], -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.form.firstName = $event),\n    type: \"text\",\n    class: _normalizeClass([\"w-full bg-[#1d1d1d] border border-white/10 rounded-lg h-12 px-4 text-white focus:border-[#c30059] focus:outline-none transition-colors\", {\n      'border-[#ff4d4d]': $setup.errors.firstName\n    }]),\n    required: \"\"\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.form.firstName]]), $setup.errors.firstName ? (_openBlock(), _createElementBlock(\"p\", _hoisted_5, _toDisplayString($setup.errors.firstName), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", null, [_cache[8] || (_cache[8] = _createElementVNode(\"label\", {\n    class: \"block text-white/90 text-sm mb-2\"\n  }, [_createTextVNode(\" Last Name \"), _createElementVNode(\"span\", {\n    class: \"text-[#ff4d4d]\"\n  }, \"*\")], -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.form.lastName = $event),\n    type: \"text\",\n    class: _normalizeClass([\"w-full bg-[#1d1d1d] border border-white/10 rounded-lg h-12 px-4 text-white focus:border-[#c30059] focus:outline-none transition-colors\", {\n      'border-[#ff4d4d]': $setup.errors.lastName\n    }]),\n    required: \"\"\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.form.lastName]]), $setup.errors.lastName ? (_openBlock(), _createElementBlock(\"p\", _hoisted_6, _toDisplayString($setup.errors.lastName), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])]), _createCommentVNode(\" Address Field \"), _createElementVNode(\"div\", null, [_cache[9] || (_cache[9] = _createElementVNode(\"label\", {\n    class: \"block text-white/90 text-sm mb-2\"\n  }, [_createTextVNode(\" City/Village \"), _createElementVNode(\"span\", {\n    class: \"text-[#ff4d4d]\"\n  }, \"*\")], -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.form.address = $event),\n    class: _normalizeClass([\"w-full bg-[#1d1d1d] border border-white/10 rounded-lg p-4 text-white focus:border-[#c30059] focus:outline-none transition-colors h-13 resize-none\", {\n      'border-[#ff4d4d]': $setup.errors.address\n    }]),\n    placeholder: \"City or village name\",\n    required: \"\"\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.form.address]]), $setup.errors.address ? (_openBlock(), _createElementBlock(\"p\", _hoisted_7, _toDisplayString($setup.errors.address), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createCommentVNode(\" Referral Code (Optional) \"), _createElementVNode(\"div\", null, [_cache[13] || (_cache[13] = _createElementVNode(\"label\", {\n    class: \"block text-white/90 text-sm mb-2\"\n  }, [_createTextVNode(\" Referral Phone Number\"), _createElementVNode(\"span\", {\n    class: \"text-gray-400\"\n  }, \"(Optional)\")], -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_8, [_withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.form.referralCode = $event),\n    ref: \"referralField\",\n    type: \"text\",\n    class: _normalizeClass([\"w-full bg-[#1d1d1d] border border-white/10 rounded-lg h-12 px-4 text-white focus:border-[#c30059] focus:outline-none transition-colors uppercase\", {\n      'border-[#ff4d4d]': $setup.errors.referralCode,\n      'border-green-500': $setup.autoFilledReferral\n    }]),\n    placeholder: \"Enter Referral phone number\",\n    autocomplete: \"off\"\n  }, null, 2 /* CLASS */), [[_vModelText, $setup.form.referralCode]]), _createElementVNode(\"button\", {\n    type: \"button\",\n    onClick: _cache[4] || (_cache[4] = (...args) => $setup.verifyReferralCode && $setup.verifyReferralCode(...args)),\n    disabled: !$setup.form.referralCode || $setup.isVerifyingReferral,\n    class: \"bg-[#c30059] text-white px-4 rounded-lg h-12 font-semibold hover:bg-[#ff4d4d] transition-colors disabled:opacity-50\"\n  }, [!$setup.isVerifyingReferral ? (_openBlock(), _createElementBlock(\"span\", _hoisted_10, \"Verify\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_11, _cache[10] || (_cache[10] = [_createElementVNode(\"i\", {\n    class: \"fas fa-spinner fa-spin\"\n  }, null, -1 /* HOISTED */)])))], 8 /* PROPS */, _hoisted_9)]), $setup.errors.referralCode ? (_openBlock(), _createElementBlock(\"p\", _hoisted_12, _toDisplayString($setup.errors.referralCode), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), $setup.referralSuccess ? (_openBlock(), _createElementBlock(\"p\", _hoisted_13, [_cache[11] || (_cache[11] = _createElementVNode(\"i\", {\n    class: \"fas fa-check-circle\"\n  }, null, -1 /* HOISTED */)), _createTextVNode(\" Valid referral code \" + _toDisplayString($setup.autoFilledReferral ? '(Auto-filled from link)' : ''), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), $setup.referralError ? (_openBlock(), _createElementBlock(\"p\", _hoisted_14, [_cache[12] || (_cache[12] = _createElementVNode(\"i\", {\n    class: \"fas fa-times-circle\"\n  }, null, -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.referralError), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true)]), _createCommentVNode(\" Submit Button \"), _createElementVNode(\"button\", {\n    type: \"submit\",\n    disabled: $setup.isLoading,\n    class: \"w-full bg-gradient-to-r from-[#c30059] to-[#ff4d4d] text-white py-4 rounded-lg font-medium text-lg hover:opacity-90 transition-opacity disabled:opacity-50 relative\"\n  }, [!$setup.isLoading ? (_openBlock(), _createElementBlock(\"span\", _hoisted_16, \"Complete Registration\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_17, _cache[14] || (_cache[14] = [_createElementVNode(\"svg\", {\n    class: \"animate-spin -ml-1 mr-3 h-5 w-5 text-white\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\"\n  }, [_createElementVNode(\"circle\", {\n    class: \"opacity-25\",\n    cx: \"12\",\n    cy: \"12\",\n    r: \"10\",\n    stroke: \"currentColor\",\n    \"stroke-width\": \"4\"\n  }), _createElementVNode(\"path\", {\n    class: \"opacity-75\",\n    fill: \"currentColor\",\n    d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n  })], -1 /* HOISTED */), _createTextVNode(\" Processing... \")])))], 8 /* PROPS */, _hoisted_15)], 32 /* NEED_HYDRATION */)])]);\n}","map":{"version":3,"names":["_imports_0","class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createCommentVNode","$setup","autoFilledReferral","referralSuccess","_hoisted_3","_cache","src","alt","onSubmit","_withModifiers","args","handleSubmit","_hoisted_4","form","firstName","$event","type","_normalizeClass","errors","required","_hoisted_5","_toDisplayString","lastName","_hoisted_6","address","placeholder","_hoisted_7","_hoisted_8","referralCode","ref","autocomplete","onClick","verifyReferralCode","disabled","isVerifyingReferral","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","referralError","_hoisted_14","isLoading","_hoisted_16","_hoisted_17","xmlns","fill","viewBox","cx","cy","r","stroke","d"],"sources":["F:\\ott_tv\\ott_frontend\\src\\components\\MiniRegistration.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen bg-[#121212] flex items-center justify-center px-4\">\n    <div class=\"w-full max-w-md\">\n      <!-- Auto-filled Referral Alert -->\n      <div v-if=\"autoFilledReferral && referralSuccess\" \n        class=\"mb-4 bg-gradient-to-r from-green-500/20 to-green-600/20 border border-green-500/30 rounded-lg p-3 text-green-400 text-sm flex items-center gap-2\">\n        <i class=\"fas fa-info-circle text-green-400\"></i>\n        <span>Referral code was automatically applied from your invitation link!</span>\n      </div>\n      <!-- Logo -->\n      <div class=\"text-center mb-8\">\n        <img src=\"@/assets/ott.jpg\" alt=\"Logo\" class=\"h-12 mx-auto mb-4\">\n        <h1 class=\"text-2xl font-bold text-white\">Complete Your Profile</h1>\n        <p class=\"text-white/60 mt-2\">Just a few more details to get started</p>\n      </div>\n\n      <!-- Mini Registration Form -->\n      <form @submit.prevent=\"handleSubmit\" class=\"space-y-6\">\n        <!-- Name Fields -->\n        <div class=\"grid grid-cols-2 gap-4\">\n          <div>\n            <label class=\"block text-white/90 text-sm mb-2\">\n              First Name <span class=\"text-[#ff4d4d]\">*</span>\n            </label>\n            <input \n              v-model=\"form.firstName\"\n              type=\"text\"\n              class=\"w-full bg-[#1d1d1d] border border-white/10 rounded-lg h-12 px-4 text-white focus:border-[#c30059] focus:outline-none transition-colors\"\n              :class=\"{'border-[#ff4d4d]': errors.firstName}\"\n              required\n            />\n            <p v-if=\"errors.firstName\" class=\"mt-1 text-[#ff4d4d] text-sm\">{{ errors.firstName }}</p>\n          </div>\n\n          <div>\n            <label class=\"block text-white/90 text-sm mb-2\">\n              Last Name <span class=\"text-[#ff4d4d]\">*</span>\n            </label>\n            <input \n              v-model=\"form.lastName\"\n              type=\"text\"\n              class=\"w-full bg-[#1d1d1d] border border-white/10 rounded-lg h-12 px-4 text-white focus:border-[#c30059] focus:outline-none transition-colors\"\n              :class=\"{'border-[#ff4d4d]': errors.lastName}\"\n              required\n            />\n            <p v-if=\"errors.lastName\" class=\"mt-1 text-[#ff4d4d] text-sm\">{{ errors.lastName }}</p>\n          </div>\n        </div>\n\n        <!-- Address Field -->\n        <div>\n          <label class=\"block text-white/90 text-sm mb-2\">\n            City/Village <span class=\"text-[#ff4d4d]\">*</span>\n          </label>\n          <input \n            v-model=\"form.address\"\n            class=\"w-full bg-[#1d1d1d] border border-white/10 rounded-lg p-4 text-white focus:border-[#c30059] focus:outline-none transition-colors h-13 resize-none\"\n            :class=\"{'border-[#ff4d4d]': errors.address}\"\n            placeholder=\"City or village name\"\n            required\n          >\n          <p v-if=\"errors.address\" class=\"mt-1 text-[#ff4d4d] text-sm\">{{ errors.address }}</p>\n        </div>\n\n        <!-- Referral Code (Optional) -->\n        <div>\n          <label class=\"block text-white/90 text-sm mb-2\">\n            Referral Phone Number<span class=\"text-gray-400\">(Optional)</span>\n          </label>\n          <div class=\"flex gap-2\">\n            <input\n              v-model=\"form.referralCode\"\n              ref=\"referralField\"\n              type=\"text\"\n              class=\"w-full bg-[#1d1d1d] border border-white/10 rounded-lg h-12 px-4 text-white focus:border-[#c30059] focus:outline-none transition-colors uppercase\"\n              :class=\"{'border-[#ff4d4d]': errors.referralCode, 'border-green-500': autoFilledReferral}\"\n              placeholder=\"Enter Referral phone number\"\n              autocomplete=\"off\"\n            />\n            <button\n              type=\"button\"\n              @click=\"verifyReferralCode\"\n              :disabled=\"!form.referralCode || isVerifyingReferral\"\n              class=\"bg-[#c30059] text-white px-4 rounded-lg h-12 font-semibold hover:bg-[#ff4d4d] transition-colors disabled:opacity-50\"\n            >\n              <span v-if=\"!isVerifyingReferral\">Verify</span>\n              <span v-else>\n                <i class=\"fas fa-spinner fa-spin\"></i>\n              </span>\n            </button>\n          </div>\n          <p v-if=\"errors.referralCode\" class=\"mt-1 text-[#ff4d4d] text-sm\">{{ errors.referralCode }}</p>\n          <p v-if=\"referralSuccess\" class=\"mt-1 text-green-500 text-sm flex items-center gap-1\">\n            <i class=\"fas fa-check-circle\"></i> Valid referral code {{ autoFilledReferral ? '(Auto-filled from link)' : '' }}\n          </p>\n          <p v-if=\"referralError\" class=\"mt-1 text-[#ff4d4d] text-sm flex items-center gap-1\">\n            <i class=\"fas fa-times-circle\"></i> {{ referralError }}\n          </p>\n        </div>\n\n        <!-- Submit Button -->\n        <button \n          type=\"submit\"\n          :disabled=\"isLoading\"\n          class=\"w-full bg-gradient-to-r from-[#c30059] to-[#ff4d4d] text-white py-4 rounded-lg font-medium text-lg hover:opacity-90 transition-opacity disabled:opacity-50 relative\"\n        >\n          <span v-if=\"!isLoading\">Complete Registration</span>\n          <span v-else class=\"flex items-center justify-center\">\n            <svg class=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n              <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\n              <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n            </svg>\n            Processing...\n          </span>\n        </button>\n      </form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, reactive, onMounted } from 'vue'\n\nexport default {\n  name: 'MiniRegistration',\n  \n  setup() {\n    const isLoading = ref(false)\n    const isVerifyingReferral = ref(false)\n    const referralSuccess = ref(false)\n    const referralError = ref('')\n    const referralField = ref(null)\n    const autoFilledReferral = ref(false)\n\n    const form = reactive({\n      firstName: '',\n      lastName: '',\n      address: '',\n      referralCode: ''\n    })\n\n    const errors = reactive({\n      firstName: '',\n      lastName: '',\n      address: '',\n      referralCode: ''\n    })\n\n    const validateForm = () => {\n      let isValid = true\n      \n      // Reset errors\n      Object.keys(errors).forEach(key => errors[key] = '')\n\n      if (!form.firstName.trim()) {\n        errors.firstName = 'First name is required'\n        isValid = false\n      }\n\n      if (!form.lastName.trim()) {\n        errors.lastName = 'Last name is required'\n        isValid = false\n      }\n\n      if (!form.address.trim()) {\n        errors.address = 'Address is required'\n        isValid = false\n      }\n\n      // In validateForm, referralCode is optional, so no validation needed\n\n      return isValid\n    }\n\n    const verifyReferralCode = async () => {\n      if (!form.referralCode) return\n      isVerifyingReferral.value = true\n      referralSuccess.value = false\n      referralError.value = ''\n      errors.referralCode = ''\n\n      try {\n        // Check if the referral code is a phone number or a referral code\n        const codeToVerify = form.referralCode.trim().toUpperCase()\n        console.log('Verifying referral code:', codeToVerify, 'Auto-filled:', autoFilledReferral.value)\n        \n        const response = await fetch(`http://192.168.0.127:8080/users/verify-referral/?code=${codeToVerify}`, {\n          headers: {\n            'Accept': 'application/json'\n          }\n        })\n        const result = await response.json()\n        if (result.status === 'success') {\n          referralSuccess.value = true\n          referralError.value = ''\n          console.log('Referral code verification successful')\n        } else {\n          referralSuccess.value = false\n          referralError.value = 'Invalid referral code'\n          console.log('Referral code verification failed:', result)\n          // Only reset autoFilledReferral if this was not an auto-filled verification\n          // This prevents the green highlight from disappearing if auto-verification fails\n          if (!autoFilledReferral.value) {\n            autoFilledReferral.value = false\n          }\n        }\n      } catch (err) {\n        console.error('Error verifying referral code:', err)\n        referralSuccess.value = false\n        referralError.value = 'Error verifying referral code'\n        // Only reset autoFilledReferral if this was not an auto-filled verification\n        if (!autoFilledReferral.value) {\n          autoFilledReferral.value = false\n        }\n      } finally {\n        isVerifyingReferral.value = false\n      }\n    }\n\n    // Function to check URL for referral code and auto-fill\n    const checkUrlForReferral = async () => {\n      // Get the URL parameters - handle both normal query params and hash params\n      let refCode = null\n      \n      // First check normal query params\n      const urlParams = new URLSearchParams(window.location.search)\n      refCode = urlParams.get('ref')\n      \n      // If not found, check hash params (after #)\n      if (!refCode && window.location.hash) {\n        const hashParts = window.location.hash.split('?')\n        if (hashParts.length > 1) {\n          const hashParams = new URLSearchParams(hashParts[1])\n          refCode = hashParams.get('ref')\n        }\n      }\n      \n      // Also check localStorage for referral code that might have been saved during login\n      if (!refCode) {\n        refCode = localStorage.getItem('referralCode')\n      }\n      \n      if (refCode) {\n        console.log('Found referral code:', refCode)\n        form.referralCode = refCode\n        autoFilledReferral.value = true\n        // Auto verify the referral code\n        await verifyReferralCode()\n      }\n    }\n    \n    // Call this function when component is mounted\n    onMounted(() => {\n      checkUrlForReferral()\n    })\n    \n    const handleSubmit = async () => {\n      if (!validateForm()) return\n\n      // If referral code is entered, must be verified\n      if (form.referralCode && !referralSuccess.value) {\n        errors.referralCode = 'Please verify the referral code first'\n        return\n      }\n\n      isLoading.value = true\n\n      try {\n        // Get CSRF token and phone\n        const csrfToken = localStorage.getItem('csrfToken')\n        const phone = localStorage.getItem('phone')\n\n        // Clear the referral code from localStorage after it's been used\n        // This prevents it from being applied to future registrations\n        localStorage.removeItem('referralCode')\n\n        if (!phone) {\n          throw new Error('Phone number is required. Please login again.')\n        }\n\n        // Make registration request with proper headers\n        const response = await fetch('http://192.168.0.127:8080/users/complete-registration/', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Accept': 'application/json',\n            'X-CSRFToken': csrfToken,\n            'X-Requested-With': 'XMLHttpRequest'\n          },\n          credentials: 'include',\n          body: JSON.stringify({\n            first_name: form.firstName,\n            last_name: form.lastName,\n            address: form.address,\n            phone: phone,\n            ...(form.referralCode ? { referral_code: form.referralCode.trim().toUpperCase() } : {})\n          })\n        })\n\n        const result = await response.json()\n\n        if (!response.ok) {\n          throw new Error(result.message || 'Registration failed')\n        }\n\n        // Update stored user data if available\n        if (result.user) {\n          localStorage.setItem('user', JSON.stringify(result.user))\n        }\n        // Update CSRF token if provided\n        if (result.csrf_token) {\n          localStorage.setItem('csrfToken', result.csrf_token)\n        }\n\n        // Mark registration as completed\n        localStorage.setItem('hasCompletedRegistration', 'true')\n\n        // Update user data in Vuex store\n        try {\n          const userResponse = await fetch(`http://192.168.0.127:8080/users/profile/?phone=${phone}`, {\n            headers: {\n              'Accept': 'application/json',\n              'X-Requested-With': 'XMLHttpRequest'\n            },\n            credentials: 'include'\n          })\n          const userData = await userResponse.json()\n          if (userData && userData.status === 'success') {\n            localStorage.setItem('user', JSON.stringify(userData.user))\n          }\n        } catch (error) {\n          console.error('Error updating user data:', error)\n        }\n\n        // Store success message for home page\n        localStorage.setItem('registrationSuccess', 'true')\n        localStorage.setItem('registrationMessage', 'Registration completed successfully!')\n\n        // Get the URL parameters\n        const urlParams = new URLSearchParams(window.location.search)\n        const redirectPath = urlParams.get('redirect')\n\n        // Force navigation to home page or redirect path\n        if (redirectPath && redirectPath !== '/mini-register') {\n          window.location.href = `http://192.168.0.127:8080${redirectPath}`\n        } else {\n          window.location.href = 'http://192.168.0.127:8080/'\n        }\n\n      } catch (error) {\n        console.error('Registration error:', error)\n        // Handle API errors\n        if (error.response?.data) {\n          const serverErrors = error.response.data;\n          Object.keys(serverErrors).forEach(key => {\n            if (Object.prototype.hasOwnProperty.call(errors, key)) {\n              errors[key] = serverErrors[key][0];\n            }\n          });\n          // Handle referral_code error if present\n          if (serverErrors.referral_code && errors.referralCode !== undefined) {\n            errors.referralCode = serverErrors.referral_code[0];\n          }\n        }\n      } finally {\n        isLoading.value = false\n      }\n    }\n\n    return {\n      form,\n      errors,\n      isLoading,\n      handleSubmit,\n      isVerifyingReferral,\n      referralSuccess,\n      referralError,\n      verifyReferralCode,\n      referralField,\n      autoFilledReferral\n    }\n  }\n}\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}